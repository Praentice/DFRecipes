{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to DFIR Recipes !","text":"<p>Having troubles with digital forensic and incident response ? We've got you covered !</p> <p>The aim of this website is to give tricks regarding digital forensic and investigation in general. Please keep in mind that this website is currently in WIP state. As a consquence of it, some pages aren't completed.</p>"},{"location":"#acknowledgment","title":"Acknowledgment","text":"<p>The informations on this website come from a lot of different authors through articles, room on TryHackMe, github repository... I have decided to compile all of these valuable informations on this very same website. You will find link to the original ressources used to create the pages of my website in the Resources section. A lot of persons helped me in one way or another to create, promote this website and gain skills in DFIR topics and ethical hacking. </p> <p>Please check their work. Without them, this website would not be at its current state.</p>"},{"location":"#who-am-i","title":"Who am I ?","text":"<p>Hello ! My name is Prantice, I'm a student in cybersecurity, I am also a DFIR (Digital Forensic Incident Response) enjoyer and the co-founder of the CTF team brain tea'sers.</p> My social networks <p>Here's my social networks, don't hesitate to send an email at contact@dfirrecipes.fr if you want to give me suggestions regarding the website.</p> Website Link Root-me Root-me Blue Team Labs Online Blue Team Labs Online Cyberdefenders Cyberdefenders Github Github Gitlab Gitlab My CTF Team No link for now ! <p>Send me an email !  Buy me a coffee ! </p>"},{"location":"Acknowledgment/","title":"Acknowledgment","text":"<p>I would like to thanks here the persons which contribute in one way or another to the creation of this website. And also to the associations, persons who helped me to gain skills regarding digital forensic and ethical hacking in general. If you want to support them, please check their website listed below. Even though your name isn't mentionned on this page (I am deeply sorry about this), you are not forgotten.</p>"},{"location":"Acknowledgment/#persons","title":"Persons","text":"Sykursen About himWebsite <p>Sykursen is a cybersecurity student but also the co-founder and founder of amazing projects in the cybersecurity world. He helped me to setup this website by giving me advices regarding its configuration.  </p> <p>Check his website</p> emarie About himWebsite N\u00b0 1Website N\u00b0 2 <p>emarie is a cybersecurity student but also the founder of the website azumi.fr. He motivated me to create this website and to purchase a premium subscription on TryHackMe which helped me to gain a lot of skills.   </p> <p>His websites is more about pentesting but you should have a look on his website if you are interested by these topics. Check his website</p> <p>His websites is more about pentesting but you should have a look on his website if you are interested by these topics. Check his website</p> tomtombinary About himWebsite <p>tomtombinary is a member of the CTF team \"Aperi'Kube\". He is specialized in reverse engineering and helped me with another person to gain valuable knowledge and skills in reverse engineering</p> <p>You should check his work if you are interested in reverse-engineering    Check his website</p> Maki About himTwitter <p>Maki is a person which is specialized in Digital Forensics. He helped me to gain a lot of new knowledge in this the DFIR domain.  </p> <p>You should can follow him on Twitter if you want   Check his twitter account</p>"},{"location":"Acknowledgment/#associations","title":"Associations","text":"Hack2G2 About itWebsite <p>Hack2G2 is a student association based in France which organize talks and workshops regarding cybersecurity topics. This association is doing a great work and helped me to gain a lot of skills.  </p> <p>Check their website</p>"},{"location":"Acknowledgment/#website","title":"Website","text":"HackTricks About itWebsite <p>HackTricks is the holy bible of ethical hacking in general. This website helped me a lot of time during CTF events.   </p> <p>Check their website</p>"},{"location":"Cryptography/Cheatsheet/RSA/","title":"RSA","text":"<p>This page aims to give commands regarding certificate, public key, privates key and more....</p>"},{"location":"Cryptography/Cheatsheet/RSA/#what-is-rsa","title":"What is RSA ?","text":"<p>RSA is an assymetrical encryption created in 1977 by Ronald Rivest, Adi Shamir and Leonard Adleman. It is widely used on the internet to secure connections between clients and server. It is used for example by the network protocol HTTPS, FTPS, SSH.... It can also be used to secure the exchange of symmetrical encryption key between two persons to encrypt a data exchange. </p>"},{"location":"Cryptography/Cheatsheet/RSA/#rsa-components","title":"RSA Components","text":"Check if two RSA component match together Public key and private keyPrivate key and CSRPrivate key and certificate <p>If the <code>diff</code> command give no output, you've got a match Text Only<pre><code># Compute the public key from the private and output the result to the_public_key.pub file\nopenssl rsa -in your_private.key -pubout &gt; the_public_key.pub\n# Check if the generated public key and the key you found are the same. \ndiff the_public_key.pub the_public_key_you_want_to_test.pub\n</code></pre></p> <p>If these two commands have the same output, you've got a match.  Text Only<pre><code>openssl pkey -in\u00a0your_private.key -pubout -outform pem | sha256sum\nopenssl req -in\u00a0CSR.csr -pubkey -noout -outform pem | sha256sum\n</code></pre></p> <p>If these two commands have the same output, you've got a match.  Text Only<pre><code>openssl pkey -in\u00a0your_private.key -pubout -outform pem | sha256sum\nopenssl x509 -in\u00a0certificate.crt -pubkey -noout -outform pem | sha256sum\n</code></pre></p>"},{"location":"Cryptography/Cheatsheet/RSA/#certificates","title":"Certificates","text":"<p>Certificates in RSA are used to authenticate a server during the connection. </p>"},{"location":"Cryptography/Cheatsheet/RSA/#extract-public-keys-from-cerder-certificates","title":"Extract public keys from CER/DER certificates","text":"<p>Use one of the following commands to extract public keys from certificates in differents formats.</p> From CRTFrom CERFrom DERFrom PEM Bash<pre><code>openssl x509 -pubkey -noout -in your_cert.crt \u00a0&gt; pubkey.pem \n</code></pre> Bash<pre><code>openssl x509 -inform der -in your_cert.cer -pubkey -noout &gt; your_cert_pub_key.pem \n</code></pre> Bash<pre><code>openssl x509 -inform der -in your_cert.der -pubkey -noout &gt; your_cert_pub_key.pem \n</code></pre> Bash<pre><code>openssl x509 -pubkey -noout -in your_cert.pem &gt; your_cert_pub_key.pem \n</code></pre>"},{"location":"Cryptography/Cheatsheet/RSA/#convert-a-certificate-between-formats","title":"Convert a certificate between formats","text":"<p>Use one of the following commands to convert a certificate between different formats.</p> CRT -&gt; PEMCER -&gt; PEMDER -&gt; PEMPEM -&gt; DERPEM -&gt; CERPEM -&gt; CRT Bash<pre><code>openssl x509 -in your_cert.crt -out your_cert.pem -outform PEM\n</code></pre> Bash<pre><code>openssl x509 -in your_cert.cer -out your_cert.pem\n</code></pre> Bash<pre><code>openssl x509 -in your_cert.der -out your_cert.pem\n</code></pre> Bash<pre><code>openssl x509 -in your_cert.pem -out your_cert.der -outform DER\n</code></pre> Bash<pre><code>openssl x509 -inform PEM -in your_cert.pem -outform DER -out your_cert.cer\n</code></pre> Bash<pre><code>openssl x509 -outform der -in your_cert.pem -out your_cert.crt\n</code></pre>"},{"location":"Cryptography/Cheatsheet/RSA/#public-and-private-keys","title":"Public and private keys","text":""},{"location":"Cryptography/Cheatsheet/RSA/#public-keys","title":"Public keys","text":"<p>Public key in the RSA encryption are used to encrypt data before sending them to the server. It can be also used by the client to authenticate the server by checking the certificate signature </p>"},{"location":"Cryptography/Cheatsheet/RSA/#extract-public-key-from-certificate","title":"Extract public key from certificate","text":"Bash<pre><code>openssl rsa -pubin -inform PEM -text -noout &lt; certificate_publickey.pem #For PEM format\n</code></pre>"},{"location":"Cryptography/Cheatsheet/RSA/#read-public-exponent-and-modulus","title":"Read public exponent and modulus","text":"Bash<pre><code>openssl rsa -pubin -inform PEM -text -noout &lt; your_certificate_public_key.pem\n</code></pre>"},{"location":"Cryptography/Cheatsheet/RSA/#private-key","title":"Private key","text":"<p>Private key are used to decrypt data which are received by the server. It is also used by the server to sign a certificate to ensure its authenticity</p>"},{"location":"Cryptography/Cheatsheet/RSA/#breaking-rsa","title":"Breaking RSA","text":"<p>Even though this encryption algorithm is impossible to break without a quantum computer. However, if you're facing a case in which this algorithm wasn't properly implemented, you may try to check the following points to see if you can compute the private and public key used for the connection.</p>"},{"location":"Cryptography/Cheatsheet/RSA/#check-if-the-key-pair-has-been-leaked","title":"Check if the key pair has been leaked","text":"<p>Sometimes, even though the key pair is impossible to break quickly, you can google the first lines of the public key or certificate (in PEM format) and see if the key pair was leaked somewhere.   </p>"},{"location":"Cryptography/Cheatsheet/RSA/#look-out-for-the-length-of-the-generated-key","title":"Look out for the length of the generated key","text":"<p>For now, It is recommended to use a length of at least 2048 bits for the generation of a new key pair.  Every key pair generated with a length inferior to 2048 bits are considered to be insecure. If you're facing a key pair considered insecure to this standard, you should proceed to the following actions :</p> <p>1) Retrieve the modulus and exponent of your public key and see if the resulting number (modulus) have known factors. If it is the case, then you should be able to regenerate from there the private key.</p> <p>2) If the factors of the modulus are unknown but the modulus is a very short number compared to the standard length used, you can try to compute the factors of the modulus by using this script. </p>"},{"location":"Cryptography/Cheatsheet/RSA/#bruteforce-encrypted-private-key","title":"Bruteforce encrypted private key","text":"<p>Sometimes, you may encouter an encrypted private key. That means that a passphrase or key file is required to decrypt the private key before being able to use it. However, you should try the following steps if you want to decrypt the key.</p> <p>1) Search in the filesystem or the memory dump of the evidence to see if there is no trace of a password which could be linked to the encrypted private key file.</p> <p>2) Try to use a bruteforce script like this one with a dictionnary such as rockyou.txt (Available in the directory <code>/usr/share/wordlists</code> for Kali Linux and Parrot OS). </p>"},{"location":"Cryptography/Cheatsheet/RSA/#look-out-for-bad-implementations","title":"Look out for bad implementations","text":"<p>Even though it is almost impossible to break a good encryption algorithm such as RSA, nothing beats a bad implementation of a cryptographic algorith. That means that you should try to have a look on the client or the server and see if the private key is readable or available somewhere. </p>"},{"location":"Cryptography/Cheatsheet/RSA/#resources","title":"Resources","text":"<p>https://cheapsslsecurity.com/p/convert-a-certificate-to-pem-crt-to-pem-cer-to-pem-der-to-pem/</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/","title":"Regex","text":"<p>The aim of this page is to give tips and tricks regarding regex and how you can write your own regular expressions for forensic purposes. Skip to the \"Ready-to-use regex\" if you're looking for useful regex.</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#charsets","title":"Charsets","text":"<p>Here's some examples to understand charsets :</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#basic","title":"Basic","text":"<ul> <li><code>[abc]</code> : Match every occurences of a, b and c.</li> <li><code>[a-c]</code> : The same as above</li> <li><code>[a-cx-z]</code> : Match every occurences of a, b, c, x, y and z.</li> <li><code>[a-zA-Z]</code> : Match any single lowercase or uppercase letter</li> <li><code>[^k]</code> : Match any single letter except the letter k which is excluded from the charset</li> </ul>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#advanced","title":"Advanced","text":"<p>Once you understood complety the Basic part of charset, we can now go through advanced examples of using charset :  - <code>[cfh]at</code> : Match the words cat, fat, hat but not bat for example - <code>[Ff]ile[1-9]</code> : Match the words File1, File2, file3, file4, file5, File7, file9 - <code>[Ff]ile[^7]</code> : Same as above except that it doesn't match the word File7 I hope these examples helped you to understand how the charset capabilities can be combined to create regex rules.</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#wildcards-and-optional-characters","title":"Wildcards and optional characters","text":"<ul> <li><code>a.c</code> : Match for example aac, abc, a0c, a$c and so on. Please note here that the <code>.</code> dot is a wildcard which allows us to match any single characters except the line break.</li> <li><code>abc?</code> : Match for example ab, abc. When using the <code>?</code> question mark, any single character which precede it will be marked as optionnal.</li> <li><code>\\</code> : This special character can be used to escape any specials characters such as <code>.</code>, <code>?</code>... For example, the regex <code>cat\\.xyz</code> will only match the string cat.xyz and not cataxyz, catbxyz and so on.</li> </ul>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#metacharacters-and-repetitions","title":"Metacharacters and repetitions","text":"<p>Even though charset are useful when it comes to creating regex/</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#metacharacters","title":"Metacharacters","text":"<ul> <li><code>\\d</code> matches a digit, like <code>9</code> </li> <li><code>\\D</code> matches a non-digit, like <code>A</code> or <code>@</code> </li> <li><code>\\w</code> matches an alphanumeric character, like <code>a</code> or <code>3</code> </li> <li><code>\\W</code> matches a non-alphanumeric character, like <code>!</code> or <code>#</code> </li> <li><code>\\s</code> matches a whitespace character (spaces, tabs, and line breaks)  </li> <li><code>\\S</code> matches everything else (alphanumeric characters and symbols)</li> </ul>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#repetitions","title":"Repetitions","text":"<ul> <li><code>{12}</code> - exactly 12 times.  </li> <li><code>{1,5}</code> - 1 to 5 times.  </li> <li><code>{2,}</code> - 2 or more times.  </li> <li><code>*</code> - 0 or more times.  </li> <li><code>+</code> - 1 or more times.</li> </ul> <p>For example, look at these regex : </p> <ul> <li><code>cats{4}</code> : Match the string catssss</li> <li><code>[Cc]ats*</code> : Match the words Cat, cats, catsss</li> <li><code>regex go br+</code> : Match the sentences regex go br, regex go brrrrrr and so on</li> </ul>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#starts-with-ends-with-groups-and-either-or","title":"Starts with/ ends with, groups, and either/ or","text":"<p>Sometimes it's very useful to specify that we want to search by a certain pattern in the beginning or the end of a line. We do that with these characters:  </p> <ul> <li><code>^</code> - starts with  </li> <li><code>$</code> - ends with</li> </ul> <p>So for example, if you want to search for a line that starts with <code>abc</code>, you can use <code>^abc</code>. If you want to search for a line that ends with <code>xyz</code>, you can use <code>xyz$</code>.</p> <p>Note: The <code>^</code> hat symbol is used to exclude a charset when enclosed in <code>[</code>square brackets<code>]</code>, but when it is not, it is used to specify the beginning of a word.</p> <p>You can also define groups by enclosing a pattern in <code>(</code>parentheses<code>)</code>. This function can be used for many ways that are not in the scope of this tutorial. We will use it to define an either/ or pattern, and also to repeat patterns. To say \"or\" in Regex, we use the <code>|</code> pipe.</p> <p>For an \"either/or\" pattern example, the pattern <code>during the (day|night)</code> will match both of these sentences: <code>during the day</code> and <code>during the night</code>. For a repetition example, the pattern <code>(no){5}</code> will match the sentence <code>nonononono</code>.</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#ready-to-use-regex","title":"Ready-to-use regex","text":"<p>You can find here a list of regex you can use to search valuable informations within any files</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#how-to-use-them","title":"How to use them ?","text":""},{"location":"Digital%20forensic/Cheatsheet/Regex/#gui-text-editor","title":"GUI text editor","text":"<p>When searching for text, select the mode \"Regular expression\" and copy paste the regex of your choice in the field \"Search\"</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#cli","title":"CLI","text":""},{"location":"Digital%20forensic/Cheatsheet/Regex/#linux","title":"Linux","text":""},{"location":"Digital%20forensic/Cheatsheet/Regex/#grep-command","title":"grep command","text":"Bash<pre><code>grep \"your_regex\" filename \ngrep -a \"your_regex\" binaryfilename\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#sed-command","title":"sed command","text":"Bash<pre><code>sed -n '/your_regex/p' filename \n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#programming-language","title":"Programming language","text":""},{"location":"Digital%20forensic/Cheatsheet/Regex/#cryptographic-data","title":"Cryptographic data","text":"<p>These regex allow you to find data regarding any cryptographic data such as public, private key and certificate in differents format</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#public-key","title":"Public key","text":"<p>This section regroups all regex which allow you to find public key anywhere</p> Public key Classic public keyRSA public key Text Only<pre><code>(-{3,}BEGIN PUBLIC KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END PUBLIC KEY-{3,})\n</code></pre> Text Only<pre><code>(-{3,}BEGIN RSA PUBLIC KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END RSA PUBLIC KEY-{3,})\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#private-key","title":"Private key","text":"Private key Openssh private keyClassic private keyRSA private key Text Only<pre><code>(-{3,}BEGIN OPENSSH PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END OPENSSH PRIVATE KEY-{3,})\n</code></pre> Text Only<pre><code>(-{3,}BEGIN PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END PRIVATE KEY-{3,})\n</code></pre> Text Only<pre><code>(-{3,}BEGIN RSA PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END RSA PRIVATE KEY-{3,})\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#certificate","title":"Certificate","text":"Certificate Certificate with line breakCertificate without line break Text Only<pre><code>(-{1,}BEGIN CERTIFICATE)-{1,}\\n([\\s\\S]*?)\\n-{1,}(END CERTIFICATE-{1,})\n</code></pre> Text Only<pre><code>(-{1,}BEGIN CERTIFICATE)-{1,}\\n?([\\s\\S]*?)\\n?-{1,}(END CERTIFICATE-{1,})\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#hash-method","title":"Hash method","text":"Hash method MD5SHA1SHA256 Text Only<pre><code>^[0-9a-fA-F]{32}$\n</code></pre> Text Only<pre><code>/\\b([a-f0-9]{40})\\b/\n</code></pre> Text Only<pre><code>^[0-9a-fA-F]{64}$\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#cryptocurrency","title":"Cryptocurrency","text":""},{"location":"Digital%20forensic/Cheatsheet/Regex/#bitcoin","title":"Bitcoin","text":"Cryptocurrency wallet Bitcoin Wallet Text Only<pre><code>/^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#encoding-methods","title":"Encoding methods","text":"Encoding methods Base64 Text Only<pre><code>(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}={2})\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#network-information","title":"Network information","text":"L2 info MAC address Text Only<pre><code>/^((([a-f0-9]{2}:){5})|(([a-f0-9]{2}-){5}))[a-f0-9]{2}$/i\n</code></pre> L3 info IPv4 addressIPv6 address Text Only<pre><code>(\\d{1,3}\\.){3}\\d{1,3}\n</code></pre> Text Only<pre><code>^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$\n</code></pre> L7 info URLDomain name Text Only<pre><code>((https?|ftp|file):\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/?\n</code></pre> Text Only<pre><code>([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/?\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#general-informations","title":"General informations","text":""},{"location":"Digital%20forensic/Cheatsheet/Regex/#email-address","title":"Email address","text":"Email address Text Only<pre><code>(\\w+)@(\\w+)\\.([a-zA-Z]{1,10})\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#phone-number","title":"Phone number","text":"Phone number regex Text Only<pre><code>/^(?:(?:\\+|00)33[\\s.-]{0,3}(?:\\(0\\)[\\s.-]{0,3})?|0)[1-9](?:(?:[\\s.-]?\\d{2}){4}|\\d{2}(?:[\\s.-]?\\d{3}){2})$/\n</code></pre> Text Only<pre><code>/^(((\\+44\\s?\\d{4}|\\(?0\\d{4}\\)?)\\s?\\d{3}\\s?\\d{3})|((\\+44\\s?\\d{3}|\\(?0\\d{3}\\)?)\\s?\\d{3}\\s?\\d{4})|((\\+44\\s?\\d{2}|\\(?0\\d{2}\\)?)\\s?\\d{4}\\s?\\d{4}))(\\s?\\#(\\d{4}|\\d{3}))?$/\n</code></pre> Text Only<pre><code>/(\\(?([\\d \\-\\)\\\u2013\\+\\/\\(]+){6,}\\)?([ .\\-\u2013\\/]?)([\\d]+))/\n</code></pre> Text Only<pre><code>/^\\\\(?([0-9]{3})\\\\)?[-.\\\\s]?([0-9]{3})[-.\\\\s]?([0-9]{4})$/\n</code></pre> Text Only<pre><code>/^(?:(?:\\d{3}-)?\\d{8}|^(?:\\d{4}-)?\\d{7,8})(?:-\\d+)?$/\n</code></pre> <p>Text Only<pre><code>/^(?:(?:\\+|00)86)?1(?:(?:3[\\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\\d])|(?:9[189]))\\d{8}$/\n</code></pre> Text Only<pre><code>/((\\+*)((0[ -]*)*|((91 )*))((\\d{12})+|(\\d{10})+))|\\d{5}([- ]*)\\d{6}/\n</code></pre></p> Text Only<pre><code>/\\(([0-9]{2}|0{1}((x|[0-9]){2}[0-9]{2}))\\)\\s*[0-9]{3,4}[- ]*[0-9]{4}/\n</code></pre> Text Only<pre><code>/(^1300\\d{6}$)|(^1800|1900|1902\\d{6}$)|(^0[2|3|7|8]{1}[0-9]{8}$)|(^13\\d{4}$)|(^04\\d{2,3}\\d{6}$)/\n</code></pre> Text Only<pre><code>/(^\\+[0-9]{2}|^\\+[0-9]{2}\\(0\\)|^\\(\\+[0-9]{2}\\)\\(0\\)|^00[0-9]{2}|^0)([0-9]{9}$|[0-9\\-\\s]{10}$)/\n</code></pre> Text Only<pre><code>/^(([+]\\d{2}[ ][1-9]\\d{0,2}[ ])|([0]\\d{1,3}[-]))((\\d{2}([ ]\\d{2}){2})|(\\d{3}([ ]\\d{3})*([ ]\\d{2})+))$/\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#resources","title":"Resources","text":""},{"location":"Digital%20forensic/Cheatsheet/Regex/#practice-regex","title":"Practice regex","text":"<p>If you want to learn more about regex, please check this tryhackme room : This is a very nice room, All the information regarding the regular expressions come from this very same room.  You can also test your regex here and here also</p>"},{"location":"Digital%20forensic/Cheatsheet/Regex/#regex-collections","title":"Regex collections","text":"<p>https://github.com/dubniczky/Regex-Collection https://github.com/aloisdg/awesome-regex https://regexpattern.com</p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/","title":"Wireshark","text":"<p>The aim of this page is to give tips and tricks regarding the analysis of pcap file with Wireshark.</p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#operands","title":"Operands","text":"Wireshark operators Word operator Symbol operator Description and &amp;&amp; Boolean operator \"and\". Needs the two conditions to be true or || Boolean operator \"or\" . Needs one of the two conditions to be true eq == Needs the two conditions to be equal ne != Needs the two conditions to not be equal gt &gt; Needs the conditions at the left to be greater than the condition at the right lt &lt; Needs the conditions at the left to be lesser than the condition at the right"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#decrypt-a-secure-protocol-with-the-key-filedata","title":"Decrypt a secure protocol with the key file/data","text":"<p>To decrypt any secure protocol, you will need the key used during the ciphering operation and configure Wireshark to use them by following these steps : </p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#decrypt-a-secure-protocol-without-the-key-filedata","title":"Decrypt a secure protocol without the key file/data","text":"<p>In case you have captured network traffic but you don't have access to used key to cipher the network stream, you can try the following tricks to attempt the deciphering of the network capture.</p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#recognize-the-security-protocol-in-usage","title":"Recognize the security protocol in usage","text":"<p>Recognizing the security protocol used during the exchange will allow you to apply specific techniques which might help you in your quest, you should do the following steps : </p> <ul> <li>Retrieve the network protocol used during the exchange. Is this Kerberos ? HTTPS ? RDP ? </li> <li>Once you know the protocol, try to find the packets in which, the client and server might exchange cryptographic data to establish the connection. It could be a \"Client Hello\" packet for example. This will allow you to get the version of the security protocol used for the exchange.</li> <li>Once you know the security protocol version, research online the version to see if it is not affected by any security flaws. It could be a CVE or even a security flaw in its implementation. Don't hesitate to specify with the version number of the security protocol, the network protocol which was using it during the exchange to get more results.  </li> </ul>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#focus-on-any-network-stream","title":"Focus on any network stream","text":"<p>In case you have a lot of network exchanges, you can follow these steps if you want to review only one network exchange :</p> <p>1) Right-click on a one of the network packet. Then select the option \"Follow \"</p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#cheatsheet-wireshark-filters","title":"Cheatsheet Wireshark filters","text":"<p>The aim of this section is to give ready-to-use filters to help you investigate any network capture. </p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#layer-2-protocol","title":"Layer 2 protocol","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#arp-protocol","title":"ARP Protocol","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters","title":"Basic filters","text":"Common filter for ARP traffic Only display ARP trafficGet only ARP requestsGet only ARP response Text Only<pre><code>arp\n</code></pre> Text Only<pre><code>arp.opcode==1\n</code></pre> Text Only<pre><code>arp.opcode==2\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters","title":"Advanced filters","text":"Detect abnormal ARP traffic Detect ARP floodingDetect ARP spoofing / poisoning <p>Text Only<pre><code>((arp) &amp;&amp; (arp.opcode == 1)) &amp;&amp; (arp.src.hw_mac == target-mac-address)\n</code></pre> Text Only<pre><code>(arp.opcode == 1) &amp;&amp; (arp.src.hw_mac == target-mac-address)\n</code></pre></p> Text Only<pre><code>arp.duplicate-address-detected or arp.duplicate-address-frame\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#mac-address","title":"MAC address","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_1","title":"Basic filters","text":"Common filter for MAC address Filter MAC address by vendorblabla2blabla3 <p>Replace 00:00:00 by the vendor mac address Text Only<pre><code>eth.src[0:3]=00:00:00\n</code></pre></p> <p>Lorem Ipsum</p> <p>Lorem Ipsum</p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_1","title":"Advanced filters","text":"To do To do Text Only<pre><code>To do\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#layer-3-protocol","title":"Layer 3 protocol","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#ip-address","title":"IP address","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_2","title":"Basic filters","text":"Common filter for IP address Display only IP packetsFilter by TTL Text Only<pre><code>ip\n</code></pre> <p>Replace 00:00:00 by the vendor mac address Text Only<pre><code>ip.ttl &lt; value\n</code></pre></p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_2","title":"Advanced filters","text":"To do To do Text Only<pre><code>To do\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#icmp-protocol","title":"ICMP Protocol","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_3","title":"Basic filters","text":"Common filter for ICMP traffic Only display ICMP traffic Text Only<pre><code>icmp\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_3","title":"Advanced filters","text":"Detect abnormal ICMP traffic Detect ICMP tunnel Text Only<pre><code>icmp and data.len &gt; 64\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#layer-4-protocol","title":"Layer 4 protocol","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#udp","title":"UDP","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_4","title":"Basic filters","text":"Common filter for UDP traffic Only display UDP trafficFilter by UDP port Text Only<pre><code>udp\n</code></pre> Text Only<pre><code>udp.port==?????\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_4","title":"Advanced filters","text":"To do To do Text Only<pre><code>To do\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#tcp","title":"TCP","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_5","title":"Basic filters","text":"Three way handshake Only display TCP SYNOnly display TCP SYN/ACK Text Only<pre><code>tcp.flags.syn==1 &amp;&amp; tcp.flags.ack==0\n</code></pre> Text Only<pre><code>tcp.flags.syn==1 &amp;&amp; tcp.flags.ack==1\n</code></pre> Common filter for TCP traffic Filter by TCP portOnly display bad checksum TCP packets Text Only<pre><code>tcp.port==?????\n</code></pre> Text Only<pre><code>tcp.checksum.status==\"bad\"\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_5","title":"Advanced filters","text":"To do To do Text Only<pre><code>To do\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#layer-5-7-protocol","title":"Layer 5 -&gt; 7 protocol","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#dhcp","title":"DHCP","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_6","title":"Basic filters","text":"Common filter for DHCP traffic Search DHCP traffic based on specific hostnameSearch a specific IP address which was requested Text Only<pre><code>dhcp.options.hostname contains \"hostname\"\n</code></pre> Text Only<pre><code>dhcp.option.type == 50 and dhcp.option.requested_ip_address == ip_address\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_6","title":"Advanced filters","text":"To do To do Text Only<pre><code>To do\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#dns","title":"DNS","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_7","title":"Basic filters","text":"Common filter for DNS traffic Only get DNS query of certain typeSearch a specific IP address which was requested Text Only<pre><code>dns.qry.type==1 &amp;&amp; dns.flags.response==1\n</code></pre> Text Only<pre><code>dhcp.option.type == 50 and dhcp.option.requested_ip_address == ip_address\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_7","title":"Advanced filters","text":"Detect abnormal DNS traffic Detect DNS tunnel <p>Detect dnscat tool usage in capture Text Only<pre><code>dns contains \"dnscat\"\n</code></pre> Detect very long DNS query / response  Text Only<pre><code>dns.qry.name &gt; 15 and !mdns\n</code></pre></p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources","title":"Resources","text":"DNS query types DNS query type Decimal value Description A 1 System status."},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#ftp","title":"FTP","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_8","title":"Basic filters","text":"Common filters for FTP traffic Only display FTP traffic Text Only<pre><code>ftp\n</code></pre> Search filters Search FTP traffic by code Text Only<pre><code>ftp.response.code==???\n</code></pre> <p>=== \"Search packets by request command     Get request where username is sent     Text Only<pre><code>ftp.request.command==USER\n</code></pre>     Get request where password is sent     Text Only<pre><code>ftp.request.command==PASS\n</code></pre></p> Search packets by filename Text Only<pre><code>ftp.request.arg == \"your.file\"\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_8","title":"Advanced filters","text":"Detect abnormal FTP traffic Detect bruteforce <p>Detect bruteforce with failed login attemps. Text Only<pre><code>(ftp.response.code == 530) and (ftp.response.arg contains \"username\")\n</code></pre> Detect bruteforce with static password Text Only<pre><code>(ftp.request.command == \"PASS\" ) and (ftp.request.arg == \"password\")\n</code></pre></p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources_1","title":"Resources","text":"<p>Use the following informations to modify the given filters for your own needs.</p> FTP Code FTP Code Description 211 System status. 212 Directory status. 213 File status (Can be used to know the size of file requested by user) 220 Service ready. 226 Transfer complete. 227 Entering passive mode. 228 Long passive mode. 229 Extended passive mode. 230 User login. 231 User logout. 331 Valid username. 430 Invalid username or password 530 No login, invalid password. FTP Command FTP Command Description USER Username PASS Password CWD Current work directory LIST List the file on the server STOR Store file on the server"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#http-https","title":"HTTP / HTTPS","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_9","title":"Basic filters","text":"Common filters for HTTP traffic Only display HTTP traffic Text Only<pre><code>http\n</code></pre> Search filters Filter by requested domain nameFilter by request method Text Only<pre><code>http.host=example.com\n</code></pre> <p>Replace ?????? by the chosen HTTP method name Text Only<pre><code>http.request.method==??????\n</code></pre> Get request where password is sent Text Only<pre><code>ftp.request.command==PASS\n</code></pre></p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_9","title":"Advanced filters","text":"Detect abnormal HTTP traffic Detect MITM attack after ARP flooding / poisoning / spoofing <p>Detect POST request being redirected to a suspect MAC address Text Only<pre><code>http.request.method==POST and http.request.full_uri=\"target-url/login.php\" and eth.addr==target-mac-address\n</code></pre></p> Grab valuable informations from HTTP traffic Get credentialsGet comments Text Only<pre><code>http.request.method==POST and http.request.full_uri=\"target url/login.php\"\n</code></pre> Text Only<pre><code>http.request.method==POST and http.request.full_uri=\"target-url/comment.php\"\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources_2","title":"Resources","text":"HTTP Code HTTP Code Description 200 (OK) Request successful. 301 (Moved permanently) Resource is moved to a new URL/path (permanently) 302 (Moved Temporarily) Resource is moved to a new URL/path (temporarily). 400 (Bad Request) Server didn't understand the request. 401 (Unauthorised) URL needs authorisation (login, etc.). 403 (Forbidden) No access to the requested URL.\u00a0 404 (Not Found) Server can't find the requested URL. 405 (Method Not Allowed) Used method is not suitable or blocked. 408 (Request Timeout)\u00a0 Request look longer than server wait time. 500 (Internal Server Error) Request not completed, unexpected error. 503 (Service Unavailable) Request not completed server or service is down. HTTP Parameters <ul> <li>User agent: Browser and operating system identification to a web server application.</li> <li>Request URI: Points the requested resource from the server.  </li> <li>Full *URI: Complete URI information.</li> <li>Server: Server service name.  </li> <li>Host: Hostname of the server</li> <li>Connection: Connection status.  </li> <li>Line-based text data: Cleartext data provided by the server.</li> <li>HTML Form URL Encoded: Web form information.</li> </ul>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#smtp","title":"SMTP","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_10","title":"Basic filters","text":"Common filter for SMTP traffic Only display SMTP traffic Text Only<pre><code>smtp\n</code></pre> Search filter Search SMTP traffic based on status code Text Only<pre><code>smtp.response.code=???\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_10","title":"Advanced filters","text":"To do To do Text Only<pre><code>To do\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources_3","title":"Resources","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#netbios","title":"Netbios","text":""},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_11","title":"Basic filters","text":"Only display Netbios traffic Only display Netbios trafficSearch netbios packets related to an host Text Only<pre><code>nbns\n</code></pre> <p>In case you have trouble finding the computer you want, try to find a pattern within the netbios packets (NetBIOS Name Service &gt; Queries &gt; Name) which could help you to filter the packets until you find the right one. Text Only<pre><code>nbns.name contains \"hostname\" \n</code></pre></p>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_11","title":"Advanced filters","text":"To do To do Text Only<pre><code>To do\n</code></pre>"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources_4","title":"Resources","text":"<p>https://www.wireshark.org/docs/dfref/f/ftp.html https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html https://www.wireshark.org/docs/dfref/</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Analysis%20Checklist/","title":"File Analysis Checklist","text":"<p>The aim of this page is to provide tips and tricks regarding the analysis of unknown files. </p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Analysis%20Checklist/#checklist-for-file-identification","title":"Checklist for file identification","text":"<p>Here's a list of actions you can do to attempt the identification of an unknown file : </p> <p>1) Check the file extension and search it on the internet or here.</p> <p>2) Launch the command <code>file</code> on the unknown file and check the output.</p> <p>3) Retrieve the magic number (The first bytes) of your sample and compare it to these data</p> <p>4) Launch the command <code>strings</code> (UTF-8) and <code>strings -el</code> (UTF-16) on the unknown file and check the output. Don't hesite to specify other UTF such as UTF-32 to get other results.</p> <p>5) Check the first bytes of the unknown file using a hexadecimal editor.</p> <p>6) Check if the unknown file is encrypted.</p> <p>7) Is the unknown file a capture of a binary data transfer ? Try to read the file as a dump of something and not as a file. </p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/","title":"File Format","text":"<p>This page aims to give trick regarding the viewing, extraction and even repairing of specific files. You can use this page to help you identify files you might recover with the help of files carver such as scalpel or photorec. </p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#file-format-list","title":"File format list","text":"<p>This sections aims to give explanation regarding the existings differents files formats and tricks on how you can read them to extract information.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ani","title":"ANI","text":"<p>.bmp format is a proprietary format developed by Microsoft for Windows. the main use is to create icons.</p> Viewing .ani file <p>These file can be viewed by any image viewer.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#asp","title":"ASP","text":"<p>.asp (active server page) format is a format developped by Microsoft for its service called Microsoft IIS. It generates the content to display in HTML to the browser on the fly.</p> Viewing .asp file <p>These file can be viewed by any text editor</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#avi","title":"AVI","text":"<p>.bmp format is a format which is used to contains videos.</p> Viewing .avi file <p>These file can be viewed by any video viewer.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#bat","title":"BAT","text":"<p>.bat format is a proprietary type of file developed by Microsoft for Windows. the main use is to create scripts launchable from a windows terminal.</p> Viewing .bat file <p>The content of these file can be viewed by using any text editor.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#bmp","title":"BMP","text":"<p>.bmp format is a proprietary format developed by Microsoft for Windows. the main use is to create images.</p> Viewing .bmp file <p>These file can be viewed by any image viewer.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#bup","title":"BUP","text":"<p>.bup format is proprietary format used by the McAfee antivirus to quarantine dangerous files on the system  </p> Viewing . file <p>These file are XOR by the software. to revert the files back to its original state, you need to perform a XOR operation on the file by using the hexadecimal key 0x2A. You can perform this operation by using this (Python script)[] or (Cyberchef)[]</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#c","title":"C","text":"<p>.c format is a format which contains source code written in C. </p> Viewing .c file <p>These file can be viewed by any text editor.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#cab","title":"CAB","text":"<p>.cab (Windows Cabinet Files or Diamond files) format is a compression format developed by Microsoft.</p> Viewing .cab file <p>These files can opened by using the software 7-Zip for example.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#chm","title":"CHM","text":"<p>.chm format is a format developed by Microsoft to contains informations saved in a compressed HTML format. It is generally used for Windows program manual.</p> Viewing .chm file <p>These files can be viewed by using any PDF viewer such as Okular.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#class","title":"CLASS","text":"<p>.class file are Java Bytecode file or compiled java source code. </p> Viewing .class file <p>These files may be decompiled by using the following softwares : (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#cp_","title":"CP_","text":"<p>To be completed</p> Viewing .cp_ file"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#csv","title":"CSV","text":"<p>.csv files are comma-separated values files.</p> Viewing .csv file <p>They can be open by using any text editor or excel-like software for better visualisation.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#dat","title":"DAT","text":"<p>.dat files are generic data files which can contains anything... They can be used as configuration, storage files for softwares or even videos... You can find them anywhere. </p> Viewing .dat file <p>There is no universal method to view these type of files since they can contains anything, the best way to analyze them is to find in which software they are used in. Else, you can try to view with a text, hexadecimal editor software...</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#db","title":"DB","text":"<p>.db files are, in general, database files which containes informations in a structured database format.  Please keep in mind that files with a .db extension aren't always databases such as Thumbs.db which contains the icons of pictures files for example.</p> Viewing .db file <p>Try softwares such as \"DB browser for SQLite\", \"Microsoft access\" or even a simple text editor to view the content of these files.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#dbx","title":"DBX","text":"<p>.dbx files are files which contains outlook emails messages. </p> Viewing .dbx file <p>Even though they aren't the most suited tool, you can use a text editor to view the content of these file\"</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#dll","title":"DLL","text":"<p>.dll files are libraries for exe files. </p> Viewing .dll file <p>These files can be decompiled by using tools such as IDA free, Ghidra...</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#doc-docx-odt","title":"DOC, DOCX, ODT","text":"<p>.doc and .docx files are files used by the software Microsoft Word whereas .odt files are used by the softwares LibreOffice Text and OpenOffice Text.</p> Viewing these types of file <p>These files can be open by using any Word-like software such as OpenOffice, Libreoffice. </p> Extracting data from theses files without executing them <p>In case you don't want or can't open the file for some reason (Corrupted, malicious file...) you can still extract data from it. Since these files are archive, you can change the current extension to .zip and then proceed to extract its content like you would do with a ZIP file. </p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#dxf","title":"DXF","text":"<p>.dxf (Drawing Exchange Format) files was developed by Autodesk as a type of universal format for storing CAD models.</p> Viewing .dxf file <p>These files can be opened by using (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#edb","title":"EDB","text":"<p>.edb files are structured database format file used by Microsoft Exchange Server software to store mailbox data from process and non-SMTP messages.</p> Viewing .edb file <p>These files can be viewed with any text, hexadecimal editor.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#evt-evtx","title":"EVT / EVTX","text":"<p>.evt and .evtx files are files created by Windows Event Viewer to logs system event for debug purposes. Their structure depends on the .dll files of the program that generated these same logs.</p> Viewing .evt file <p>These files can be viewed by using any text, hexadecimal editor software. You can also use the following tools available on Github to parse and properly view these types of files. Don't hesitate to use the tool \"Event Viewer\" available on Windows to read them.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#exe","title":"EXE","text":"<p>.exe are Windows Executable files.</p> Viewing .exe file <p>These files can be decompiled by using tools such as Ghidra, IDA Free...</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#f","title":"F","text":"<p>No information has been found regarding this extension.</p> Viewing .f file <p>You may need to analyze the file before attempting to execute it for security purposes.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#gif","title":"GIF","text":"<p>.gif files are a popular format for animated images.</p> Viewing .gif file <p>These files can be viewed by any image viewer software</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#gz","title":"GZ","text":"<p>.gz files are compressed files in gz format.</p> Viewing .gz file <p>These files can be uncompressed by using software like 7-zip...</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#h","title":"H","text":"<p>.h files are header files for the C,C++,C# programming languages.</p> Viewing .h file <p>These files can be viewed with any text editor.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#hdr","title":"HDR","text":"<p>.hdr (High Dynamic Range) files are images files.</p> Viewing .hdr file <p>These files can be opened by using softwares like Adobe Photoshop for example.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#html","title":"HTML","text":"<p>.html (Hypertext markup language file) files are the standard web page format type on the format.</p> Viewing .html file <p>They can be opened by using web browser, text editor... The choice is yours here.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#icc","title":"ICC","text":"<p>.icc files is a color profile format standardized by the International Color Consortium</p> Viewing .icc file <p>They can be opened by using (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ico","title":"ICO","text":"<p>.ico files are image file format for computer icons in Microsoft Windows.</p> Viewing .ico file <p>These files can be viewed by using any image viewer software.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#idf","title":"IDF","text":"<p>.idf files are used interoperate between electronic design automation (EDA) software and solid modeling mechanical computer-aided design (CAD) software.</p> Viewing .idf file <p>These files can be opened by using (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#inf","title":"INF","text":"<p>.inf files are configuration files for Windows programs, drivers...</p> Viewing .inf file <p>These files can be opened by using text editor softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ini","title":"INI","text":"<p>.ini files are message configuration documents for Windows and MS-DOS programs.</p> Viewing .ini file <p>These files can be opened by using text editor softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#java","title":"JAVA","text":"<p>.java files are source code files written in java (programming language).</p> Viewing .java file <p>These files can be opened by using text editor softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#jpg","title":"JPG","text":"<p>.jpg files is format used to represent images.</p> Viewing .jpg file <p>These files can be viewed by using any image viewer softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#jsp","title":"JSP","text":"<p>.jsp (Java Server Pages) files are, like .php files, files which returns HTML code once executed by the web server (Except here that instead of PHP, we use java to generate the output of the file).</p> Viewing .jsp file <p>These files can be opened by using any text editor softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#lnk","title":"LNK","text":"<p>.lnk files are used to create a shortcut to the original files (Document, pictures...), folder...</p> Viewing .lnk file <p>These files can be viewed by using any text editor softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#max","title":"MAX","text":"<p>.max format is used to represent data in a three-dimensional scene for video games, movies...</p> Viewing .max file <p>These files may be opened by using Autodesk 3ds Max.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mdb","title":"MDB","text":"<p>.mdb files are database structured format files used by Microsoft Access software up to the 2003 version. This format is replaced by the ACCDB one.</p> Viewing .mdb file <p>These files can be opened by using Microsoft Access 2003 or \"DB Browser for SQLite database\" software</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mid","title":"MID","text":"<p>.mid files are Musical Instrument Digital (MID) interface files, it doesn't include audio but notes, timing, duration and desired loudness for each note.</p> Viewing .mid file <p>These files can be opened by using (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mov","title":"MOV","text":"<p>.mov files are Apple QuickTime Movie files which are basically videos.</p> Viewing .mov file <p>These files can be opened by using VLC software for example.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mp3","title":"MP3","text":"<p>.mp3 are audio files.</p> Viewing .mp3 file <p>These files can be opened by using VLC, Audacity softwares...</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mpg","title":"MPG","text":"<p>.mpg are videos files.</p> Viewing .mpg file <p>These files can be opened by using VLC software</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#msg","title":"MSG","text":"<p>.msg format is a proprietary type of file developped by Microsoft for Outlook, they can contains email sent from the local pc.</p> Viewing .msg file <p>You can use the script msg_extract from github to view .msg files</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#one","title":"ONE","text":"<p>.one format is a proprietary type of file developped by Microsoft for the software Onenote. It contains note written by using the same software. </p> Viewing .msg file <p>You can use the script msg_extract from github to view .msg files</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#pct","title":"PCT","text":"<p>.pct files are Macintosh pict image.</p> Viewing .pct file <p>These files can be opened by using any image viewer software.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#pdf","title":"PDF","text":"<p>.pdf files are document files format created by Adobe Systems.</p> Viewing .pdf file <p>These files can be opened by using any PDF viewer like acrobat reader for example.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#analyzing-a-pdf-file","title":"Analyzing a PDF File","text":"<p>Extract all images from PDF file :  Text Only<pre><code>pdfimages -j file.pdf path/to/output/dir\n</code></pre></p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#pf","title":"PF","text":"<p>.pf files are files used by Microsoft Windows for its prefetch trace files.</p> Viewing .pf file <p>These files can be opened by using any text editor</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#png","title":"PNG","text":"<p>.png files are images files.</p> Viewing .png file <p>These files can be opened by using any image viewer, editor software.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ppt","title":"PPT","text":"<p>.ppt files are files used by Microsoft power point software to create presentations.</p> Viewing .ppt file <p>These files can be opened by using any \"Microsoft power point\"-like softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ps","title":"PS","text":"<p>.ps files are images saved in the Adobe PostScript language.</p> Viewing .ps file <p>These files can be opened by using (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#reg","title":"REG","text":"<p>.reg files are registration files used by the Windows registry.</p> Viewing .reg file <p>These files can be opened by using any text editor software</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#rtf","title":"RTF","text":"<p>.rtf (Rich Text Format) file is text format which can includes extra informations regarding font style, formatting, images...</p> Viewing .rtf file <p>They can be opened by using any \"Word\"-like or simple text editor softwares</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#svg","title":"SVG","text":"<p>.svg files are vectors files used to display two-dimensional graphics, charts and illustrations on web site.</p> Viewing .svg file <p>These files can be opened by using any image viewer software</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#swc","title":"SWC","text":"<p>.swc files are package of precompiled Flash symbols for .swf files.</p> Viewing .swc file <p>These files can be opened by using (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#swf","title":"SWF","text":"<p>.swf files are Shockwave Flash Movie file created by Adobe.</p> Viewing .swf file <p>These files can be decompiled by using (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#tif","title":"TIF","text":"<p>.tif files are images created in the GeoTIFF format.</p> Viewing .tif file <p>These files can be opened by using any image viewer software.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ttf","title":"TTF","text":"<p>.ttf files are font files for text.</p> Viewing .pct file <p>These files can be opened by using font files editor softwares</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#txt","title":"TXT","text":"<p>.txt files are text files.</p> Viewing .txt file <p>These files can be opened by using any text editor software</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#url","title":"URL","text":"<p>.url are internet shortcut files.</p> Viewing .url file <p>These files can be opened by using any text editor software.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wab","title":"WAB","text":"<p>.wab files are used by Microsoft Outlook Express software to contains contact data.</p> Viewing .wab file <p>These files can be opened by using text editor softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wav","title":"WAV","text":"<p>.wav (Waveform Audio file format) files are audio files.</p> Viewing .wav file <p>These files can be opened by using VLC, audacity softwares...</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wdb","title":"WDB","text":"<p>.wdb files are database files used by Microsoft Works software.</p> Viewing .wdb file <p>These files can be opened by using text editor softwares.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wk4","title":"WK4","text":"<p>.wk4 files are files used by the software Lotus1-2-3.</p> Viewing .wk4 file <p>They can be opened by using any text editor.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wma","title":"WMA","text":"<p>.wma (windows Media Audio) files are proprietary format developed by Microsoft.</p> Viewing .wma file <p>These files can be viewed by using VLC, audacity format...</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wmf","title":"WMF","text":"<p>.wmf (Windows Meta File) are proprietary image format developped by Microsoft.</p> Viewing .wmf file <p>These files can be opened by using (TO BE COMPLETED)</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wmv","title":"WMV","text":"<p>.wmv files are video files.</p> Viewing .wmv file <p>These files can be opened by using VLC software for example.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wps","title":"WPS","text":"<p>.wps files are files created by Microsoft Works. They are almost identical to .doc files except for one or two minor differences.</p> Viewing .wps file <p>You can try to convert them into doc files with the right tools.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#xls","title":"XLS","text":"<p>.xls files are used by Microsoft Excel software.</p> Viewing .xls file <p>These files can be opened by using \"Excel\"-like software.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#xml","title":"XML","text":"<p>.xml files are structured text files which can be used for a variety of purposes.</p> Viewing .xml file <p>These files can be viewed by using any text editor software.</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#zip","title":"ZIP","text":"<p>.zip files are compressed files.</p> Viewing .zip file <p>They can be opened by using appropriate software such as 7-zip, winrar...</p>"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#resources","title":"Resources","text":"<p>Please note that the informations mentionned earlier were obtained by checking the following websites.</p> <p>https://en.wikipedia.org/wiki/List_of_file_formats</p> <p>https://fileinfo.com</p> <p>https://docs.fileformat.com</p> <p>https://www.lifewire.com</p> <p>https://file.org</p>"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/","title":"Android filesystem","text":"<p>This page aims to give tricks regarding the Android filesystem such as the interesting files for example.</p> <p>WARNING !</p> <p>Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised machine.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#automated-analysis","title":"Automated analysis","text":"<p>If you want to speed up investigation on an android device, you can use the following tools : </p> Name of the tool Description Link ALEAPP Android log parser ALEAPP Autopsy General log parser Autopsy"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#manual-analysis","title":"Manual analysis","text":"<p>In case you need to search specific informations regarding the device, you can check the following path :</p>"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#general-informations","title":"General informations","text":"Path Notes"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#storage-informations","title":"Storage informations","text":"Path Notes"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#bluetooth-informations","title":"Bluetooth informations","text":"Path Notes"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#clipboard-informations","title":"Clipboard informations","text":"Path Notes"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#credits","title":"Credits","text":"<ul> <li>SANS Institute for their amazingly made posters</li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Android/Memory%20analysis/Android%20memory%20analysis/","title":"Android memory analysis","text":"<p>This page aims to give tricks regarding the analysis of Linux/Android memory dump by using Volatility.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Android/Memory%20analysis/Android%20memory%20analysis/#get-a-memory-dump","title":"Get a memory dump","text":""},{"location":"Digital%20forensic/OS%20Forensic/Android/Memory%20analysis/Android%20memory%20analysis/#android","title":"Android","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/","title":"Filesystem analysis","text":"<p>This page aims to give tricks regarding the Linux filesystem such as the interesting files for example.</p> <p>WARNING !</p> <p>Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised machine.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#manual-analysis","title":"Manual analysis","text":"<p>In case you need to search specific informations regarding the computer, you can check the following path.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#system-and-os-informations","title":"System and OS informations","text":"<p>The path mentionned in this section will help you to gather informations on the computer. </p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#os-release-information","title":"OS release information","text":"OS release information Path N\u00b01 Text Only<pre><code>/etc/os-release\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#user-accounts-information","title":"User accounts information","text":"User accounts information Path N\u00b01 Text Only<pre><code>/etc/passwd\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#user-group-information","title":"User group information","text":"User group information Path N\u00b01 Text Only<pre><code>/etc/group\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#sudoers-list","title":"Sudoers list","text":"Sudoers list Path N\u00b01 Text Only<pre><code>/etc/sudoers\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#login-information","title":"Login information","text":"Login information Path N\u00b01 Text Only<pre><code>/var/log/wtmp\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#authentication-logs","title":"Authentication logs","text":"Authentication logs Path N\u00b01Path N\u00b02Path N\u00b03 Text Only<pre><code>/var/log/auth.log\n</code></pre> Text Only<pre><code>/var/log/auth.log.2\n</code></pre> Text Only<pre><code>/var/log/auth.log.3\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#persistence-mechanism","title":"Persistence mechanism","text":"<p>The path mentionned in this section will help you to to detect any backdoor that might have been installed on a machine.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#cron-jobs","title":"Cron jobs","text":"Cron jobs crontabcronanacron Text Only<pre><code>/etc/crontab\n</code></pre> Text Only<pre><code>/var/spool/cron\n</code></pre> Text Only<pre><code>/var/spool/anacron\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#services","title":"Services","text":"Services Path N\u00b01 Text Only<pre><code>/etc/init.d\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#drivers","title":"Drivers","text":"Get the list of installed drivers Command N\u00b01 Text Only<pre><code>lsmod\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#bash-shell-startup","title":"Bash shell startup","text":"Bash shell startup Path N\u00b01Path N\u00b02Path N\u00b03 Text Only<pre><code>/home/&lt;user&gt;/.bashrc\n</code></pre> Text Only<pre><code>/etc/bash.bashrc\n</code></pre> Text Only<pre><code>/etc/profile\n</code></pre> SystemV Path N\u00b01Path N\u00b02Path N\u00b03 Text Only<pre><code>/etc/init.d/*\n</code></pre> Text Only<pre><code>/etc/rc*.d/*\n</code></pre> Text Only<pre><code>/etc/init/*\n</code></pre> Systemd Path N\u00b01Path N\u00b02 Text Only<pre><code>/lib/systemd/system/*\n</code></pre> Text Only<pre><code>/etc/systemd/system/*\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#system-configuration","title":"System configuration","text":"<p>The path mentionned in this section will help you to gather informations on the system configuration of the computer</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#hostname","title":"Hostname","text":"Hostname Path N\u00b01 Text Only<pre><code>/etc/hostname\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#timezone-information","title":"Timezone information","text":"Timezone information Path N\u00b01 Text Only<pre><code>/etc/timezone\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#network-interfaces","title":"Network interfaces","text":"Network interfaces Path N\u00b01 Text Only<pre><code>/etc/network/interfaces\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#running-processes","title":"Running processes","text":"Running processes Path N\u00b01 Text Only<pre><code>/home/*/.*_history\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#dns-information","title":"DNS information","text":"DNS information Path N\u00b01Path N\u00b02 Text Only<pre><code>/etc/hosts\n</code></pre> Text Only<pre><code>/etc/resolv.conf\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#evidence-of-execution","title":"Evidence of execution","text":"<p>The path mentionned in this path will help you to gather informations on the processes executed by the computer</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#authentication-logs_1","title":"Authentication logs","text":"Authentication logs Path N\u00b01 Text Only<pre><code>/var/log/auth.log* \n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#bash-history","title":"Bash History","text":"Bash history Path N\u00b01 Text Only<pre><code>/home/&lt;user&gt;/.bash_history\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#text-editor-history","title":"Text editor history","text":"Text editor history Vim - Path N\u00b01Nano - Path N\u00b01 Text Only<pre><code>/home/&lt;user&gt;/.viminfo\n</code></pre> Text Only<pre><code>/home/&lt;user&gt;/.bash_history\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#process-information","title":"Process information","text":"Past process Retrieve the executed binary Text Only<pre><code>/proc/pid_number/exe\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#log-files","title":"Log files","text":"<p>The path mentionned in this section will help you to gather informations on what happened on a given computer</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#syslogs","title":"Syslogs","text":"Syslogs logs Path N\u00b01 Text Only<pre><code>/var/log/syslog* \n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#authentication-logs_2","title":"Authentication logs","text":"Authentication logs Get event connection logsGet all successful connectionsGet all failed connections Text Only<pre><code>/var/log/auth.log* \n</code></pre> Text Only<pre><code>/var/log/wtmp\n</code></pre> Text Only<pre><code>/var/log/btmp\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#daemon-logs","title":"Daemon logs","text":"Authentication logs Path N\u00b01 Text Only<pre><code>/var/log/daemon.log*\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#third-party-logs","title":"Third-party logs","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#web-server","title":"Web server","text":"Web server logs Apache2Nginx Access.log <p>Text Only<pre><code>/var/log/apache2\n</code></pre> See the list of user-agent who sent request Text Only<pre><code>cat /var/log/apache2/access.log | awk '{print $(NF)}' | uniq\n</code></pre> Get the list of path requested (only 200) Text Only<pre><code>cat /var/log/apache2/access.log | grep 200 | awk '{print $7}' | uniq\n</code></pre> Get the list of path requested by nmap  Text Only<pre><code>cat /var/log/apache2/access.log | awk '{print $7}' | uniq\n</code></pre></p> Text Only<pre><code>/var/log/auth.log* \n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#resources","title":"Resources","text":"<ul> <li>https://tryhackme.com/room/linuxforensics</li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/","title":"Linux memory analysis","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-2-and-3","title":"Volatility 2 and 3","text":"<p>This page aims to give tricks regarding the analysis of Linux/Android memory dump by using Volatility.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#get-a-memory-dump","title":"Get a memory dump","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#get-a-memory-profile","title":"Get a memory profile","text":"<p>This section will help you to get find the right memory profile to use for your investigations.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#check-memory-profile","title":"Check memory profile","text":"<p>cat memory.dump | grep BOOT | tail -n 10</p>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#identify-the-os-and-kernel-versions-used","title":"Identify the OS and kernel versions used","text":"<p>Before you start doing anything, I suggest you to identify the OS and kernel version  used by the computer at the same moment when the memory was dumped.  </p> <p>Use one of the following commands to determine the OS and kernel version of your memory dump.</p> Identifying the OS and kernel version Using Linux commandsUsing Volatility 3 Text Only<pre><code>cat ...\n</code></pre> Text Only<pre><code>cat ...\n</code></pre> <p>Based on the results, you have two possibilities : </p> <ul> <li>Consult the Resources section and check the link to see if the memory profile you're searching have been already created</li> <li>Create your own memory profile if the memory profile you're searching doesn't exist.  If you found the right memory profile, you can directly skip to the section called \"Install the memory profile\"</li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#create-a-virtual-machine-with-the-same-specs","title":"Create a virtual machine with the same specs","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#install-the-prerequisites","title":"Install the prerequisites","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#compile-the-kernel","title":"Compile the kernel","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#generate-the-memory-profile","title":"Generate the memory profile","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-2","title":"Volatility 2","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-3","title":"Volatility 3","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#install-the-memory-profile","title":"Install the memory profile","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-2_1","title":"Volatility 2","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-3_1","title":"Volatility 3","text":""},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#resources","title":"Resources","text":"Precompiled volatility profile Volatility 2Volatility 3 <p>Here is a list of precompiled memory profile you can use to find the right memory profile for your investigation.</p> Description Link Volatility2 symbols from Podalirius Link Volatlity2 Compilation of volatility2 profiles by volatility foundation Link <p>Here is a list of precompiled symbols you can use to find the right symbol for your investigation</p> Description Link Volatility3 symbols from Podalirius Link Isf server from techanarchy Link Volatility 3 symboles tables Link"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/","title":"Process forensic","text":"<p>is page aims to give tricks regarding the analysis of process dump memory for forensic purposes.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-a-process-memory-dump","title":"Get a process memory dump","text":""},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#windows","title":"Windows","text":"<p>You can easily get the memory dump of a process by using these tools from Sysinternals : procdump and process hacker.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#linux","title":"Linux","text":""},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#android","title":"Android","text":"<p>You can easily get the memory dump of a process by using the frida tool</p>"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#for-all-process","title":"For all process","text":""},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-notable-strings","title":"Get notable strings","text":"Bash<pre><code>strings mem.raw &gt; destination_file.txt\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#dump-aes-keys","title":"Dump AES keys","text":"Text Only<pre><code>findaeskey mem.raw &gt; aes_keys.txt\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#web-navigator-process","title":"Web navigator process","text":"<p>This sections aims to give tricks regarding the analysis of process dump from web navigator. </p>"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-visited-url","title":"Get visited URL","text":"Text Only"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-form-for-authentication","title":"Get form for authentication","text":"Text Only"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-tslssl-informations","title":"Get TSL/SSL informations","text":""},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#private-key","title":"Private key","text":""},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#public-key","title":"Public key","text":""},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#certificate","title":"Certificate","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/","title":"Investigation using the GUI compromised machine","text":"<p>The aims of this page is to give tips and tricks regarding the investigation of a compromised machine by using its GUI.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/#sysinternals","title":"Sysinternals","text":"<p>Sysinternals is a set of tool created by ... in ????. If you want to conduct investigation on the compromised machine, you will be more likely to use the following tools from Sysinternals :  - Procexp64 - Procmon64 - ???</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/#windows-explorer","title":"Windows explorer","text":"<p>The windows explorer is the file explorer GUI used by Windows to allow the user to navigate within the computer folder without having to use the terminal.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/#get-windows-version","title":"Get Windows Version","text":"<p>1) Open the windows explorer 2) Left-click on \"This PC\" 3) Right-click on the opened windows, then choose \"Properties\" 4) You have now access to the windows version used on the machine</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/#event-viewer","title":"Event Viewer","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/","title":"Powershell and Terminal","text":"<p>The aim of this page is to give tips and tricks regarding windows investigation by using the powershell or terminal console of the compromised machine. </p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#user-accounts","title":"User accounts","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#get-last-login-information-for-all-local-accounts","title":"Get last login information for all local accounts","text":"<p>PowerShell<pre><code>Get-LocalUser | Select Name, Lastlogon\n</code></pre> or PowerShell<pre><code>$([ADSI]\"WinNT://$env:COMPUTERNAME\").Children | where {$_.SchemaClassName -eq 'user'} | Select Name, Lastlogin\n</code></pre> or PowerShell<pre><code>net user USERNAME\n</code></pre></p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#processes-and-scheduled-tasks","title":"Processes and scheduled tasks","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#get-list-of-scheduled-tasks","title":"Get list of scheduled tasks","text":"<p>PowerShell<pre><code>Get-ScheduledTask\n</code></pre> or Text Only<pre><code>schtasks /query\nschtasks /query /v /fo LIST\nschtasks /query /v /fo LIST /TN \"name of the task\"\n</code></pre></p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#get-list-of-c2-servers","title":"Get list of C2 servers","text":"PowerShell<pre><code>Get-Content C:\\Windows\\System32\\drivers\\etc\\hosts #Useful to check for DNS Poisoning\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/","title":"The windows registry","text":"<p>The aim of this page is to conduct investigation within the windows registry.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#what-is-the-windows-registry","title":"What is the windows registry ?","text":"<p>The Windows Registry is a collection of databases that contains the system's configuration data. This configuration data can be about the hardware, the software, or the user's information. It also includes data about the recently used files, programs used, or devices connected to the system. As you can understand, this data is beneficial from a forensics standpoint. Throughout this room, we will learn ways to read this data to identify the required information about the system. You can view the registry using regedit.exe, a built-in Windows utility to view and edit the registry. We'll explore other tools to learn about the registry in the upcoming tasks.</p> <p>The Windows registry consists of Keys and Values. When you open the regedit.exe utility to view the registry, the folders you see are Registry Keys. Registry Values are the data stored in these Registry Keys. A Registry Hive is a group of Keys, subkeys, and values stored in a single file on the disk.</p> <p>The registry on any Windows system contains the following five root keys:</p> Five root keys HKEY_CURRENT_USER \\ HKCUHKEY_USERS \\ HKUHKEY_LOCAL_MACHINE \\ HKLMHKEY_CLASSES_ROOT \\ HKCRHKEY_CURRENT_CONFIG \\ HKCC <p>Contains the root of the configuration information for the user who is currently logged on. The user's folders, screen colors, and Control Panel settings are stored here. This information is associated with the user's profile. This key is sometimes abbreviated as HKCU. Path location :  Text Only<pre><code>C:\\Windows\\Users\\user\\NTUSER.DAT\n</code></pre></p> <p>Contains all the actively loaded user profiles on the computer. HKEY_CURRENT_USER is a subkey of HKEY_USERS. HKEY_USERS is sometimes abbreviated as HKU. Path location :  Text Only<pre><code>C:\\Windows\\Users\\user\\NTUSER.DAT\n</code></pre></p> <p>Contains configuration information particular to the computer (for any user). This key is sometimes abbreviated as HKLM. Path location :  Text Only<pre><code>C:\\Windows\\System32\\config\\*\n</code></pre></p> <p>This is a subkey of\u00a0<code>HKEY_LOCAL_MACHINE\\Software</code>. The information that is stored here makes sure that the correct program opens when you open a file by using Windows Explorer. This key is sometimes abbreviated as HKCR. Starting with Windows 2000, this information is stored under both the HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER\u00a0keys. The\u00a0<code>HKEY_LOCAL_MACHINE\\Software\\Classes</code>\u00a0key contains default settings that can apply to all users on the local computer.\u00a0The\u00a0<code>HKEY_CURRENT_USER\\Software\\Classes</code>\u00a0key has settings that override the default settings and apply only to the interactive user. The HKEY_CLASSES_ROOT key provides a view of the registry that merges the information from these two sources. HKEY_CLASSES_ROOT also provides this merged view for programs that are designed for earlier versions of Windows. To change the settings for the interactive user, changes must be made under\u00a0<code>HKEY_CURRENT_USER\\Software\\Classes</code>\u00a0instead of under HKEY_CLASSES_ROOT. To change the default settings, changes must be made under\u00a0<code>HKEY_LOCAL_MACHINE\\Software\\Classes</code>. If you write keys to a key under HKEY_CLASSES_ROOT, the system stores the information under\u00a0<code>HKEY_LOCAL_MACHINE\\Software\\Classes</code>. If you write values to a key under HKEY_CLASSES_ROOT, and the key already exists under\u00a0<code>HKEY_CURRENT_USER\\Software\\Classes</code>, the system will store the information there instead of under\u00a0<code>HKEY_LOCAL_MACHINE\\Software\\Classes</code>. Path location :  Text Only<pre><code>C:\\Windows\\System32\\config\\*\n</code></pre></p> <p>Contains information about the hardware profile that is used by the local computer at system startup. Path location :  Text Only<pre><code>C:\\Windows\\System32\\config\\*\n</code></pre></p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#tools-for-the-windows-registry","title":"Tools for the windows registry","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#acquire-the-windows-registry","title":"Acquire the windows registry","text":"Name Description Link KAPE Tool to acquire the windows registry KAPE Autopsy Tool to acquire the windows registry, hard drive and conduct investigations on these elements Autopsy FTK Imager Tool to acquire, extract files from hard drive FTK Imager"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#explore-the-windows-registry","title":"Explore the windows registry","text":"Name Description Link Registry viewer Tool to acquire the windows registry Registry Viewer Zimmerman's registry explorer Tool to explore the windows registry Zimmerman's blog RegRipper Tool to explore the windows registry RegRipper"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#system-informations-and-system-accounts","title":"System informations and system accounts","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#os-version","title":"OS version","text":"<p><code>SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion</code></p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#current-control-set","title":"Current control set","text":"<p>The last good known configuration is stored here : <code>SYSTEM\\ControlSet001</code></p> <ul> <li><code>SYSTEM\\ControlSet002</code></li> <li><code>SYSTEM\\Select\\Current</code></li> <li><code>SYSTEM\\Select\\LastKnownGood</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#computer-name","title":"Computer Name","text":"<ul> <li><code>SYSTEM\\CurrentControlSet\\Control\\ComputerName\\ComputerName</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#time-zone-information","title":"Time zone information","text":"<ul> <li><code>SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#network-interfaces-and-past-networks","title":"Network interfaces and past networks","text":"<ul> <li> <p><code>SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces</code></p> </li> <li> <p><code>SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Signatures\\Unmanaged</code></p> </li> <li> <p><code>SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Signatures\\Managed</code></p> </li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#autostart-programs","title":"Autostart programs","text":"<ul> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code></li> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code></li> <li><code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code></li> <li><code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\Run</code></li> <li><code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#scheduled-tasks","title":"Scheduled tasks","text":"<ul> <li><code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\Taskcache\\Tasks</code></li> <li><code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\Taskcache\\Tree</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#sam-hive-and-user-information","title":"SAM Hive and user information","text":"<ul> <li><code>SAM\\Domains\\Account\\Users</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#usage-or-knowledge-of-filesfolders","title":"Usage or knowledge of files/folders","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#recent-files","title":"Recent files","text":"<ul> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs</code></li> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\\.ext</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#office-recent-files","title":"Office recent files","text":"<ul> <li><code>NTUSER.DAT\\Software\\Microsoft\\Office\\VERSION</code></li> <li><code>NTUSER.DAT\\Software\\Microsoft\\Office\\15.0\\Word</code></li> <li><code>NTUSER.DAT\\Software\\Microsoft\\Office\\VERSION\\UserMRU\\LiveID_####\\FileMRU</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#shellbags","title":"Shellbags","text":"<ul> <li><code>USRCLASS.DAT\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\Bags</code></li> <li><code>USRCLASS.DAT\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\BagMRU</code></li> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\BagMRU</code></li> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\Bags</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#opensave-and-lastvisited-dialog-mrus","title":"Open/Save and LastVisited dialog MRUs","text":"<ul> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\OpenSavePIDlMRU</code></li> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRU</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#windows-explorer-addresssearch-bars","title":"Windows explorer address/search bars","text":"<ul> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths</code></li> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\WordWheelQuery</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#executed-programs","title":"Executed programs","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#userassist","title":"UserAssist","text":"<ul> <li><code>NTUSER.DAT\\Software\\Microsoft\\Windows\\Currentversion\\Explorer\\UserAssist\\{GUID}\\Count</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#shimcache","title":"ShimCache","text":"<ul> <li><code>SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache</code> <code>AppCompatCacheParser.exe --csv &lt;path to save output&gt; -f &lt;path to SYSTEM hive for data parsing&gt; -c &lt;control set to parse&gt;</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#amcache","title":"AmCache","text":"<ul> <li><code>C:\\Windows\\appcompat\\Programs\\Amcache.hve</code> <code>Amcache.hve\\Root\\File\\{Volume GUID}\\</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#bamdam","title":"BAM/DAM","text":"<ul> <li><code>SYSTEM\\CurrentControlSet\\Services\\bam\\UserSettings\\{SID}</code></li> <li><code>SYSTEM\\CurrentControlSet\\Services\\dam\\UserSettings\\{SID}</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#external-devices","title":"External devices","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#device-identification","title":"Device identification","text":"<ul> <li><code>SYSTEM\\CurrentControlSet\\Enum\\USBSTOR</code></li> <li><code>SYSTEM\\CurrentControlSet\\Enum\\USB</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#firstlast-times","title":"First/Last Times","text":"<ul> <li><code>SYSTEM\\CurrentControlSet\\Enum\\USBSTOR\\Ven_Prod_Version\\USBSerial#\\Properties\\{83da6326-97a6-4088-9453-a19231573b29}\\####</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#usb-devices-volume-name","title":"USB devices volume name","text":"<ul> <li><code>SOFTWARE\\Microsoft\\Windows Portable Devices\\Devices</code></li> </ul>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#resources","title":"Resources","text":"<p>https://tryhackme.com/room/windowsforensics1 http://www.herongyang.com/Windows/Registry-Hives-HKCR-HKCU-HKLM-HKU-HKCC-HCPD.html</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/","title":"Event ID","text":"<p>The aim of this page is to give you the list of interesting ID to query through the Windows GUI tool Event Viewer per log life. </p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#automated-analysis","title":"Automated analysis","text":"<p>If you want to automate the analysis of windows event logs, you should export the log from the compromised machine : </p> Windows event logs path location <p>You can find the windows event logs file in the following path :  Text Only<pre><code>C:\\Windows\\System32\\winevt\\Logs\n</code></pre></p> <p>Then, you can use the following tools to assist you : </p> Tools to analyze evtx logs DeepBlueCLI <p>This tool allows you to easily detect suspicious events within the windows event log. Click here to access the repo</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#manual-analysis","title":"Manual analysis","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#windows-defender","title":"Windows Defender","text":"<p>The aim of this file is log any action on WIndows Defender. </p> <p>1116 : Threat detected 1117 : Threat quarantined 5001 : Real time scan desactivated</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#security","title":"Security","text":"<p>This file contains events related to the host security in general. </p> <p>4624 : Successful login (User Logon) 4647 : User logoff 4688 : Process Creation 4697 : A service was installed on the machine</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#powershell","title":"Powershell","text":"<p>This file contains events related to Powershell in general. </p> <p>800 : Pipeline execution details</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#system","title":"System","text":"<p>This file contains events logged by applications. </p> <p>7045 : Service was installed 6006 : Log record was disabled 1102 : Log record was erased</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#terminalservices-localsessionmanager","title":"TerminalServices-LocalSessionManager","text":"<p>21 : Remote desktop session for user opened 23 : Remote desktop session for user closed</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#sysmon","title":"Sysmon","text":"<p>You can find these logs in the following path on Event Viewer :  \"Applications and Services Logs\" -&gt; \"Microsoft\" -&gt; \"Windows\" -&gt; \"Sysmon\" -&gt; \"Operational\"</p> <p>8 : Create Remote Thread 11 : File creation 17 : Pipeline creation</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Log%20analysis/Event%20ID/#resources","title":"Resources","text":"<p>https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/ https://github.com/sans-blue-team/DeepBlueCLI</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/","title":"Windows memory analysis","text":"<p>This page aims to give tricks regarding the analysis of Windows memory by using Volatility</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-a-memory-dump","title":"Get a memory dump","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dumping-tools","title":"Dumping tools","text":"<p>To retrieve a memory dump from a windows machine, you can use the following tools : </p> Tools for memory dump Name Description Link FTK-Imager FTK-Imager Redline Redline DumpIt.exe Most useful DumpIt.exe WinDD32.exe / WinDD64.exe WinDD.exe"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#artifacts-files","title":"Artifacts files","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#physical-machine","title":"Physical machine","text":"<p>Also, you can try to retrieve specifics files if you don't want to dump the memory with the tool. You should search for the following file</p> Name Description Path hiberfil.sys Hibernation File generated by the Windows OS to speed up the boot process. Use it if you can't dump the RAM memory %SystemDrive%/hiberfil.sys <p>And then, convert it to a memory dump readable by volatility : </p> Convert a hiberfil.sys into a memory dump Volatility2Comae Toolkit <p>Get information on the hiberfil.sys file Text Only<pre><code>vol.py hibinfo -f hiberfil.sys -O hiber.mem --profile=WhatEver\n</code></pre> Convert hiberfil.sys file into memory dump Text Only<pre><code>vol.py imagecopy -f hiberfil.sys -O hiber.mem --profile=WhatEver\n</code></pre> Convert the memory dump into a crashdump Text Only<pre><code>vol.py raw2dmp -f hiber.mem -O hiber.dmp --profile=WhatEver\n</code></pre></p> <p>Convert hiberfil.sys into crash dump file. Download here the toolkit Text Only<pre><code>Hibr2Dmp.exe hiberfil.sys hiberfile.dmp\n</code></pre></p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#virtual-machine","title":"Virtual machine","text":"<p>In case you have to lead investigations on a virtual machine, you simply need to copy these file without having to interact with the virtual machine : </p> Name Description Link VMware - .vmem file Hyper-V - .bin file Parallels - .mem file VirtualBox - .sav file For this type of hypervisor, you will need to dump the memory like a normal bare-metal system Convert a virtual snapshot VMWareVirtualBox vmss2core.exeBin2Dmp.exeVolatility2 <p>If the snapshot file is from a Windows8/Server 2012, then runs this one :  Text Only<pre><code>vmss2core.exe -W8 snapshot.vmsn snapshot.vmem\n</code></pre> Else, the following one will do wonders Text Only<pre><code>vmss2core.exe -W snapshot.vmsn snapshot.vmem\n</code></pre></p> Text Only<pre><code>Bin2Dmp.exe vmware.vmem vmware.dmp\n</code></pre> Text Only<pre><code>vol.py -f vmware.vmem --profile=WWhatEver raw2dmp -O vmware.dmp\n</code></pre> vboxmanagevboxelf2raw.sh Text Only<pre><code>vboxmanage debugvm \"win7test\" dumpvmcore --filename testvbox.elf\n</code></pre> <p>You can use the following script to extract only the raw memory dump from the VirtualBox memory dump :  Text Only<pre><code>Bin2Dmp.exe vmware.vmem vmware.dmp\n</code></pre></p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#investigation","title":"Investigation","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#volatility2","title":"Volatility2","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#identify-the-os-system","title":"Identify the OS system","text":"<p>Before starting the investigation, you will need to determine the OS used on the machine. So, you need to run one of the following commands</p> Text Only<pre><code>volatility -f file.dmp imageinfo \nvolatility -f file.dmp kdbgscan \n</code></pre> <p>Once you have identified the OS used on the machine, save the found profile nearby, you're going to need it for the rest of your investigation when running volatility commands. </p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#general-informations-on-the-memory-dump","title":"General informations on the memory dump","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-hostname-of-computer","title":"Get hostname of computer","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#first-way","title":"First way","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp printkey -K \"Software\\Microsoft\\Windows Media\\WMSDK\\General\"\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#second-way","title":"Second way","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp printkey -K \"ControlSet001\\Control\\ComputerName\\ActiveComputerName\"\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#third-way","title":"Third way","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp hivelist # Retrieve virtual address of \\REGISTRY\\MACHINE\\SYSTEM\nvolatility --profile=PROFILE -f file.dmp `printkey -o virtual_address -K \"ControlSet001\\services\\Tcpip\\Parameters\"`\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-environment-variables","title":"Get the environment variables","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp envars\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-file-cached-in-the-memory-dump","title":"Get the file cached in the memory dump","text":"Text Only<pre><code>photorec path/to/mem/dump #Get All Files with photorec\nvolatility --profile=PROFILE -f file.dmp filesystem\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-list-of-running-processes","title":"Get the list of running processes","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-list-of-process","title":"Get list of process","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp pslist\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-hidden-processes","title":"Get hidden processes","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp psxview\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-list-of-loaded-modules","title":"Get list of loaded modules","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp ldrmodules\n</code></pre> <p>Once you ran this command, lookup for processes with have the 'False' value in one of the following column : Inload, InInit or InMem. Identifying potential suspect process can be useful to speed up the research. </p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-list-of-loaded-dll-files","title":"Get list of loaded DLL files","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp dlllist #For all the loaded DLL\nvolatility --profile=PROFILE -f file.dmp dlllist\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-list-of-unexcepted-patches-on-the-system","title":"Get list of unexcepted patches on the system","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp apihooks\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-a-process","title":"Dump a process","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-any-process","title":"Dump any process","text":"Text Only<pre><code>volatility --profile=PROFILE -f path/to/mem/dump memdump -p your_pid --dump-dir .\nstrings your_pid.dmp &gt; your_pid.txt #Retrieve only strings char from process dump\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-malicious-process","title":"Dump malicious process","text":"<p>Text Only<pre><code>volatility --profile=PROFILE -f file.dmp malfind -D path/to/destination\n</code></pre> You can then proceed to get a hash from the file and submit it to Virustotal and Hybrid Analysis to know more about the malware you found</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-dll-files-used-by-a-process","title":"Dump DLL files used by a process","text":"Text Only<pre><code>volatility --profile=PROFILE -f file.dmp dlldump --pid=PID -D path/to/destination\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-command-list","title":"Get command list","text":"Text Only<pre><code>volatility --profile=PROFILE -f path/to/mem/dump cmdlist\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#informations-on-network-connections","title":"Informations on network connections","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-current-network-connections","title":"Dump current network connections","text":"Text Only<pre><code>volatility --profile=PROFILE -f path/to/mem/dump netscan #Does not support WindowsXP profile\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#volatility3","title":"Volatility3","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#identify-the-os-system_1","title":"Identify the OS system","text":"Text Only<pre><code>vol -f path/to/file banners.Banners #Get banners of memory dump\nvol -f path/to/file imageinfo #Get information regarding\nvol -f path/to/file windows.info\n</code></pre> <p>NTBuildLab : Build version of the OS SystemTime : Time at which the memory dump was done</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-environment-variables_1","title":"Get the environment variables","text":"Text Only<pre><code>vol -f path/to/file windows.envars\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-file-cached-in-the-memory-dump_1","title":"Get the file cached in the memory dump","text":"Text Only<pre><code>vol -f path/to/file windows.filescan\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#processes","title":"Processes","text":""},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-list-of-running-processes_1","title":"Get the list of running processes","text":"Text Only<pre><code>vol -f path/to/file windows.pslist\nvol -f path/to/file windows.psscan\nvol -f path/to/file windows.pstree\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-a-process_1","title":"Dump a process","text":"Text Only<pre><code>vol -f path/to/file -o /path/to/dump/dir windows.memmap.Memmap --pid=pid_proc --dump\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#search-valuables-informations-within-process-dump","title":"Search valuables informations within process dump","text":"<p>In case you want to analyze a process dump, please check this page.</p>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-dll-imported-by-process","title":"Get DLL imported by process","text":"Text Only<pre><code>vol -f path/to/file windows.dlllist | grep pid\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-command-list_1","title":"Get command list","text":"Text Only<pre><code>vol -f path/to/file windows.cmdlist\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#informations-on-network-connections_1","title":"Informations on network connections","text":"Text Only<pre><code>vol -f path/to/file windows.netstat\n</code></pre>"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#resources","title":"Resources","text":"<p>SANS Institute memory forensic cheat sheet v1.2 https://diverto.github.io/2019/11/05/Extracting-Passwords-from-hiberfil-and-memdumps</p>"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/","title":"iOS filesystem","text":"<p>This page aims to give tricks regarding the iOS filesystem such as the interesting files for example.</p> <p>WARNING !</p> <p>*Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised device. *</p>"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#automated-analysis","title":"Automated analysis","text":"<p>If you want to speed up investigation on an android device, you can use this tool : </p> Name of the tool Description Link ALEAPP iOS log parser ILEAPP Autopsy General log parser Autopsy"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#manual-analysis","title":"Manual analysis","text":"<p>In case you need to search specific informations regarding the device, you can check the following path :</p>"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#general-informations","title":"General informations","text":"Path Notes"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#storage-informations","title":"Storage informations","text":"Path Notes"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#bluetooth-informations","title":"Bluetooth informations","text":"Path Notes"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#clipboard-informations","title":"Clipboard informations","text":"Path Notes"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/","title":"Flash memory forensic","text":"<p>This page aims to give specifics tricks regarding the analysis of flash storage media (USB keys, any memory cards..)</p>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/#running-performance-test","title":"Running performance test","text":"Testing I/O performance <p>These commands will compromise the evidence integrity ! Please proceed with caution. </p> f3write and f3read commands <p>Write large files to the card     Text Only<pre><code>./f3write /media/username/AAAA-HHHH/  \n</code></pre> Check if the card contains the written files     Text Only<pre><code>./f3read /media/username/AAAA-HHHH/ \n</code></pre></p> Testing capacity size <p>This command will compromise the evidence integrity ! Please proceed with caution. </p> f3probe command Text Only<pre><code>sudo f3probe --destructive --time-ops /dev/mmcblkX \n</code></pre>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/#repair-flash-memory-card","title":"Repair flash memory card","text":"Fixing the flash memory card <p>This command will compromise the evidence integrity ! Please proceed with caution. </p> f3fix command Text Only<pre><code>./f3fix --last-sec=any_value /dev/mmcblkX\n</code></pre>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/#resources","title":"Resources","text":"<p>https://fight-flash-fraud.readthedocs.io/en/latest/introduction.html#testing-performance-with-f3read-f3write</p>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Hard%20drive%20forensic/","title":"Hard drive forensic","text":"<p>This section aims to give specifics tricks regarding the analysis of hard drive.</p> Checking hard drive health smartctl command <p>Install package smartmontools before issuing the command      Text Only<pre><code>smartctl -i /dev/sdX  \n</code></pre></p> Get informations on the hard drive hdparm command <p>This command can compromise the evidence integrity ! Please proceed with caution.     Text Only<pre><code>sudo hdparm -I /dev/sdX\n</code></pre></p> List partition of hard drive <p>This command can compromise the evidence integrity ! Please proceed with caution.     Text Only<pre><code>mmls /path/to/file/disk\n</code></pre></p> Get filesystem of partiton Get partition filesystem with command <p>This command can compromise the evidence integrity ! Please proceed with caution.     Text Only<pre><code>sudo hdparm -I /dev/sdX\n</code></pre></p> Get partition filesystem manually <p>This command can compromise the evidence integrity ! Please proceed with caution.     Text Only<pre><code>mmls /path/to/file/disk\n</code></pre></p> Convert hard drive image between format  VMDK -&gt; RAWRAM -&gt; QCOW2VMDK -&gt; QCOW2OVA -&gt; QCOW2 Text Only<pre><code>qemu-img convert path/to/file.vmdk path/to/new/file.raw \n</code></pre> Text Only<pre><code>qemu-img convert path/to/file.raw path/to/new/file.qcow2\n</code></pre> Text Only<pre><code>qemu-img convert -f vmdk path/to/file.vmdk path/to/new/file.qcow2 \n</code></pre> <p>First step : Get the vmdk file     Text Only<pre><code>tar xf path/to/file.ova -C .\n</code></pre> Second step : Convert the VMDK file to QCOW2 file     Text Only<pre><code>qemu-img convert -f vmdk path/to/file.vmdk path/to/new/file.qcow2\n</code></pre> Third step (optionnal) : Reduce the size of the generated file     Text Only<pre><code>qemu-img convert -O qcow2 path/to/new/file.qcow2 path/to/new/file-shrunk.qcow2\n</code></pre></p>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Hard%20drive%20forensic/#resources","title":"Resources","text":""},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/","title":"Storage media forensic","text":"<p>This sections aims to give generals tricks regarding the investigation of any storage media. </p>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#acquire-a-storage-media-image-from-device","title":"Acquire a storage media image from device","text":""},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#cloning-a-storage-media","title":"Cloning a storage media","text":"DDRescue tool Install DDRescue toolClone a storage media locallyClone a storage media through network <p>For Debian and Ubuntu  Text Only<pre><code>sudo apt install gddrescue # Debian and Ubuntu\n</code></pre></p> Text Only<pre><code>ddrescue -d -r3 /dev/sda test.img test.logfile\n</code></pre> Text Only<pre><code>ddrescue -d -r3 /dev/sda test.img test.logfile\n</code></pre> DD tool Clone a storage media locallyClone a storage media through network Text Only<pre><code>dd if=path/to/disk of=path/to/output\n</code></pre> <p>Launch this command on the analyst machine :  Text Only<pre><code>(analyst)$ nc -lvp 3615 | bzip2 -d | dd bs=16M of=linux_disk.dmp\n</code></pre> And launch this command on the infected machine Text Only<pre><code>sudo dd bs=16M if /dev/sda status=progress | bzip2 -c | nc -v @IP 3615\n</code></pre> Wait for the transfer to end and make sure to check the file integrity after the transfer  Text Only<pre><code>ls -lah | grep linux_disk\n</code></pre></p> EWF tools Install EWF toolsClone a storage media locallyGet metadata from EWF file <p>For Debian and Ubuntu Text Only<pre><code>dd if=path/to/disk of=path/to/output\n</code></pre> For Arch, EndeavourOS and Manjaro Text Only<pre><code>sudo pacman -S libewf #Arch and Manjaro\n</code></pre></p> Text Only<pre><code>ewfacquire /dev/sdX\n</code></pre> Text Only<pre><code>ewfinfo /path/to/file\n</code></pre>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#mount-a-storage-media-image-device","title":"Mount a storage media image / device","text":"Mount a specific format of disk image .EWF Format <p>First, you need to open the container by typing this command :      Text Only<pre><code>sudo ewfmount /path/to/ewf/file /mnt/where/you/want\n</code></pre> This will open the evidence file and the disk itself will be accessible at the path <code>/mnt/where/you/want/ewf1</code> Once you're finished, you can type this command to unmount the evidence file :      Text Only<pre><code>sudo umount /mnt/where/you/want\n</code></pre></p> Mount a storage media without encryption Storage media with single partition Text Only<pre><code>mount -o ro,loop,norecovery /path/to/storage/media /mnt/where/you/want\n</code></pre> <p>The flag <code>ro</code> allow us to mount the disk in read-only mode, the flag <code>loop</code> allow us to mount the disk as a loop device and the flag <code>norecovery</code> allow us to mount the disk, even though the filesystem is in a dirty state (Which means that the filesystem was not recovered)</p> Storage media with multiple partition <p>First step : Retrieve the first sector number of the needed partition (a) and the sector size (b) Text Only<pre><code>fdisk -l /path/to/file\n</code></pre> Second step : Mount the needed partition by specifying the values found during the previous step  Text Only<pre><code>mount -o ro,loop,norecoveryoffset=$((a*b)) /path/to/file.img /mnt\n</code></pre></p> <p>The flag <code>ro</code> allow us to mount the disk in read-only mode, the flag <code>loop</code> allow us to mount the disk as a loop device and the flag <code>norecovery</code> allow us to mount the disk, even though the filesystem is in a dirty state (Which means that the filesystem was not recovered). Finally, the flag offset allow us to mount the partition of our choice by specifying its start offset.</p> Unmount a storage media <p>First way : Unmount the folder on which the storage media is mounted Text Only<pre><code>umount /mnt/folder\n</code></pre> Second way : Unmount the disk itself Text Only<pre><code>umount /dev/sdX\n</code></pre></p> Mount a storage media with encryption Bitlocker (Windows)LUKS (Linux)Filevault (Mac OS X) PassphraseKey file Text Only<pre><code>TO DO\n</code></pre> Text Only<pre><code>TO DO\n</code></pre> PassphraseKey file <p>First step : Decrypt the partition. the command will ask you a password.     Text Only<pre><code>sudo cryptsetup luksOpen /path/to/encrypted/partition your_volume_name\n</code></pre> Second step : Mount the decrypted volume on your filesystem     Text Only<pre><code>sudo mount /dev/mapper/your_volume_name /mnt/path/\n</code></pre> Third step : Don't forget to close the volume after !      Text Only<pre><code>sudo cryptsetup luksClose your_volume_name\n</code></pre></p> <p>First step : Decrypt the partition with the key file path.      Text Only<pre><code>sudo cryptsetup luksOpen --key-file yourkeyfile.key /path/to/encrypted/partition your_volume_name\n</code></pre> Second step : Mount the decrypted volume on your filesystem     Text Only<pre><code>sudo mount /dev/mapper/your_volume_name /mnt/path/\n</code></pre> Third step : Don't forget to close the volume after !      Text Only<pre><code>sudo cryptsetup luksClose your_volume_name\n</code></pre></p> Tool installationEncryption key in hex format <p>Clone the libfvde github repository. For further details regarding the installation and building of libfvde, go check this link ! Text Only<pre><code>git clone https://github.com/libyal/libfvde/ &amp;&amp; cd libfvde &amp;&amp; ./synclibs.sh\n</code></pre> Install the required packages     Text Only<pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade &amp;&amp; udo apt install git autoconf automake autopoint libtool pkg-config flex bison\n</code></pre> In the root folder of the github repository, issue the following commands :      Text Only<pre><code>./autogen.sh\n./configure\nmake\n</code></pre> If eveything went all, you will be able to mount filevault encrypted partition.</p> <p>First step : Retrieve the first sector number of the needed partition (a) and the sector size (b)     Text Only<pre><code>fdisk -l /path/to/file\n</code></pre> Second step : Decrypt the volume by specifying the offset computed during the previous step      Text Only<pre><code>sudo ./libfvde/fvdetools/fvdemount -k the_hex_encoded_encryption_key -o $((a*b)) your_encrypted_volume /tmp/volume\n</code></pre> Third step : Mount the decrypted volume on your filesystem     Text Only<pre><code>sudo mount /tmp/volume /mnt/path/\n</code></pre></p>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#analyze-a-storage-media-image-device","title":"Analyze a storage media image / device","text":"Analyze the storage media to gather informations Get the file system Text Only<pre><code>parted -m /path/to/file print | tail -n +3 | awk -F \":\" '{print $(NF-2)}'\n</code></pre> Analyze the storage media to gather files Getting the current filesRetrieve the deleted files <p>Text Only<pre><code>testdisk path/to/disk/image\n</code></pre> Press Enter -&gt; None -&gt; Advanced -&gt; List</p> Text Only<pre><code>=== \"extundelete\"\n    ```\n    extundelete path/to/disk/image\n    ```\n=== \"binwalk\"\n    ```\n    binwalk\n    ```\n=== \"foremost\"\n    ```\n    foremost\n    ```\n=== \"bulkextractor\"\n    ```\n    bulkextractor\n    ```\n=== \"photorec\"\n    ```\n    photorec\n    ```\n=== \"scalpel\"\n    ```\n    scalpel\n    ```\n</code></pre>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#fixing-a-storage-media-image-device","title":"Fixing a storage media image / device","text":"Fix the filesystem NTFSOthers Text Only<pre><code>ntfsfix /dev/sdX\n</code></pre> Text Only<pre><code>sudo fsck -p /path/to/file\n</code></pre>"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#resources","title":"Resources","text":"<p>https://wiki.evolix.org/HowtoLUKS</p>"},{"location":"Environment%20setup/Local%20lab%20setup/","title":"Local lab setup","text":"<p>The aim of this page is to help you configure your own local forensic lab for forensic purposes. For security reasons, this local lab should only be accessible from your host and virtual machines. sudo virsh net-autostart default WARNING !</p> <p>Please note that the configuration explained here is unsafe for the studies of malware programs ! Use this configuration at your own risk, I am not responsible for any misuses and damage done to your computer.</p> <p>This page will help you configure your computer to get the following functionalities for your host and virtual machines : </p> <ul> <li>Local website which hosts severals services and resources such as Cyberchef, PDF documents...</li> <li>Local FTP server which allow you to easily transfer files between virtual machines</li> </ul>"},{"location":"Environment%20setup/Local%20lab%20setup/#installation","title":"Installation","text":"<p>First, update your system with these commands :  Text Only<pre><code>sudo apt update &amp;&amp; sudo apt upgrade # For ubuntu and debian\nsudo pacman -Syu # For arch based system\n</code></pre> Then, install the following softwares on your pc :  Text Only<pre><code>sudo apt install vsftpd nginx dnsmasq #Ubuntu and Debian system\nyay -S vsftpd nginx dnsmasq #For arch based systems\nsudo pacman -S vsftpd nginx dnsmasq #Alternative for arch based system\n</code></pre> Now that you have installed the required software, we can now configure them </p>"},{"location":"Environment%20setup/Local%20lab%20setup/#configuration","title":"Configuration","text":""},{"location":"Environment%20setup/Local%20lab%20setup/#dnsmasq","title":"DNSmasq","text":"<p>The aim of this section is to configure the DNS server so you can access your own offline lab without using an IP address.</p> <p>The first step is to get the IP address of the host machine. Use the following command and spot the virtual network interface :  Text Only<pre><code>ifconfig #First command\nip addr show #Second command\n</code></pre> Note the IP address you found, you will use it later.  Now that we have our own IP address, we can configure the dnsmasq service. Open the configuration file <code>/etc/dnsmasq.conf</code> and add the following line to the end : </p> <p>Text Only<pre><code>bind-interfaces  \n# Put here the DNS server of your choice\nserver=1.1.1.1 \nlog-queries  \n\n# does not go upstream to resolve addresses ending in 'your-domain.lab'  \nlocal=/your-domain.lab/\n</code></pre> Then change the configuration of the file <code>/etc/resolv.conf</code> to use dnsmasq to resolve address by changing this line :  Text Only<pre><code>nameserver 127.0.0.1\n</code></pre> And don't forget to add your domain name in the <code>/etc/hosts</code> file :  Text Only<pre><code>your_libvirt_ip_address your_domain.lab\n</code></pre> You should now be able to access your own local lab by using the domain name you choose.  </p>"},{"location":"Environment%20setup/Local%20lab%20setup/#web-server","title":"WEB server","text":""},{"location":"Environment%20setup/Local%20lab%20setup/#home-page","title":"Home page","text":"<p>The first step we're going to do is to configure the WEB server so it can host our services. The default public location of nginx is <code>/usr/share/nginx/html</code>.  You can use the following source code to replace the default file <code>index.html</code> :  HTML<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Home lab&lt;/title&gt;\n        &lt;link rel=\"stylesheet\" href=\"style.css\"&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n    &lt;h1&gt;Welcome !&lt;/h1&gt;\n    &lt;p&gt;Choose the service you want to access&lt;/p&gt;\n        &lt;table&gt;\n            &lt;thead&gt;\n                &lt;tr&gt;\n                    &lt;th colspan=\"2\"&gt;Resources link&lt;/th&gt;\n                &lt;/tr&gt;\n            &lt;/thead&gt;\n            &lt;tbody&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;&lt;a href=\"http://localhost/\"&gt;Home&lt;/a&gt;&lt;/td&gt;\n                    &lt;td&gt;Repertoire de base&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;&lt;a href=\"http://localhost/\"&gt;Resource N\u00b0 1&lt;/a&gt;&lt;/td&gt;\n                    &lt;td&gt;Lorem Ipsum&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;&lt;a href=\"http://localhost/\"&gt;Resource N\u00b0 2&lt;/a&gt;&lt;/td&gt;\n                    &lt;td&gt;Lorem Ipsum &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;&lt;a href=\"http://localhost/\"&gt;Resource N\u00b0 2&lt;/a&gt;&lt;/td&gt;\n                    &lt;td&gt;Lorem Ipsum&lt;/td&gt;\n                &lt;/tr&gt;\n\n            &lt;/tbody&gt;\n        &lt;/table&gt;\n        &lt;br&gt;\n    &lt;p&gt;&lt;em&gt;Created by YOUR_NAME, local usage only.&lt;/em&gt;&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> Feel free to add rows to the table to add your own resources. </p>"},{"location":"Environment%20setup/Local%20lab%20setup/#enable-directory-listing","title":"Enable directory listing","text":"<p>To enable directory listing in nginx, you need to configure the configuration file <code>/etc/nginx/nginx.conf</code> and add these lines within the 'server' location. Text Only<pre><code>location / {  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0root \u00a0\u00a0/usr/share/nginx/html;  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0index \u00a0index.html index.htm;  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n</code></pre> Don't forget to restart nginx with this command :  Text Only<pre><code>sudo systemctl restart nginx\n</code></pre> And you should be able to browse the directory within the web server.</p>"},{"location":"Environment%20setup/Local%20lab%20setup/#add-services","title":"Add services","text":"<p>Now that your web server is configured, you can add the services of your choice. Personally, I choose to install cyberchef on my own lab.</p>"},{"location":"Environment%20setup/Local%20lab%20setup/#cyberchef","title":"Cyberchef","text":"<p>To install Cyberchef on your local web server, create a new directory called <code>cyberchef</code> in <code>/usr/share/nginx/html</code>. Once it's done, you can download the latest release of cyberchef and unzip the file content within the <code>cyberchef</code> directory. Don't forget to rename the html file to <code>index.html</code> and you should be able to use cyberchef on your own PC offline through the web server. </p>"},{"location":"Environment%20setup/Local%20lab%20setup/#add-whatever-you-want","title":"Add whatever you want","text":"<p>From now on, you should have a fully functionnal web server. Based on your needs and occupations, why not install on the web server, services you think are essential to you ?  The choice is yours ! </p>"},{"location":"Environment%20setup/Local%20lab%20setup/#ftp-server","title":"FTP server","text":"<p>The aim of this section is to help you deploy a FTP server to easily transfer files between your virtual and host machine.</p>"},{"location":"Environment%20setup/Local%20lab%20setup/#locate-the-root-folder-of-your-service","title":"Locate the root folder of your service","text":"<p>The first step is to locate the folder of the FTP server. In my case, it is <code>/var/ftp/pub</code>.</p>"},{"location":"Environment%20setup/Local%20lab%20setup/#create-an-user-for-the-ftpuser","title":"Create an user for the FTPuser","text":"<p>Text Only<pre><code>sudo useradd -md /var/ftp/pub ftpuser #Create a user called ftpuser and set its home directory in /var/ftp/pub\nsudo passwd ftpuser #Add a password to the account\nsudo mkdir /var/ftp/pub/home #Create a folder called home in the path /var/ftp/pub\n</code></pre> Now that the user is created, we can now configure the FTP server : </p>"},{"location":"Environment%20setup/Local%20lab%20setup/#configure-the-vsftpd-service","title":"Configure the vsftpd service","text":"<p>Locate and modify the file <code>/etc/vsftpd.conf</code>. Make sure that the following lines are configured in the same fashion on your side : </p> Text Only<pre><code>#Disable anonymous login\nanonymous_enable=NO\n#Allow local user to connect to the servers\nlocal_enable=YES\n# Uncomment this to enable any form of FTP write command.  \nwrite_enable=YES #Enable writing in the folders\n# Activate directory messages - messages given to remote users when they  \n# go into a certain directory.\n#messages given to remote users when they go into a certain directory.  \ndirmessage_enable=YES\n# Activate logging of uploads/downloads.\nxferlog_enable=YES\n# Make sure PORT transfer connections originate from port 20 (ftp-data).\nconnect_from_port_20=YES\n# Add a banner when a user connects on the FTP server:\nbanner_file=/var/ftp/banner\n#Force local user to stay within the folder they connected in\nchroot_local_user=YES\n# Listen for IPv4 sockets \nlisten=YES\n# Set own PAM service name to detect authentication settings specified  \n# for vsftpd by the system package.  \npam_service_name=vsftpd\n# Make sure that the folder designated in 'local_root' directive is not writable\nlocal_root=/var/ftp/pub\n#Minimum port for creating passive connections\npasv_min_port=40000\n#Maximum port for creating passive connections\npasv_max_port=50000\n# Create a whitelist of users which can access the ftp server\nuserlist_enable=YES\n#Don't forget to create the file mentionned in the directive 'userlist_file' \n#and to add the user created earlier in it !\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n#Disable SELinux for vsftpd to avoid bugs \nseccomp_sandbox=NO\n# Permissions applicated to any files and folder uploaded on the server.\nfile_open_mode=0777\n# Remove executions rights from the uploaded folders and files\nlocal_umask=0011\n</code></pre>"},{"location":"Environment%20setup/Local%20lab%20setup/#create-the-banner","title":"Create the banner","text":"<p>Use the following commands to create the banner which will be used by the server  Text Only<pre><code>sudo touch /var/ftp/banner\nsudo nano /var/ftp/banner #Write whatever you want in this file\n</code></pre></p>"},{"location":"Environment%20setup/Local%20lab%20setup/#create-the-userlist","title":"Create the userlist","text":"<p>Use the following commands to create the userlist which will be used by the server  Text Only<pre><code>sudo touch /etc/vsftpd.userlist\necho ftpuser &gt;&gt; /etc/vsftpd.userlist \n</code></pre></p>"},{"location":"Environment%20setup/Local%20lab%20setup/#configure-the-permissions","title":"Configure the permissions","text":"Text Only<pre><code>sudo chown root:root /etc/vsftpd.conf\nsudo chown ftpuser:ftpuser -R /var/ftp/pub/home\nsudo chmod 777 -R /var/ftp/pub/home\nsudo chmod 555 /var/ftp/pub #Disable write access for anyone in the path /var/ftp/pub\n</code></pre>"},{"location":"Environment%20setup/Local%20lab%20setup/#launching-the-service","title":"Launching the service","text":"<p>Text Only<pre><code>sudo systemctl enable vsftpd #Allow the service vsftp to start on the machine startup\nsudo systemctl disable vsftpd #Disallow the service vsftp to start on the machine startup\nsudo systemctl restart vsftpd #Restart the vsftpd service after you change its configuration\n</code></pre> If everything went well, you should have access to a fully functional FTP service on which you can upload anything you want !</p>"},{"location":"Environment%20setup/Local%20lab%20setup/#accessing-your-local-ftp-server","title":"Accessing your local FTP server","text":"<p>Personnaly, I decided to use the FTP client called Filezilla. It is free, under GNU/GPL license and can be installed on any platforms such as Windows, Linux... Just download the software from the official website,  install it on your virtual machines and you're good to go !</p>"},{"location":"Environment%20setup/Local%20lab%20setup/#firewall","title":"Firewall","text":""},{"location":"Environment%20setup/Local%20lab%20setup/#configuration-of-the-firewall","title":"Configuration of the firewall","text":"<p>Before you can access your services, make sure that the firewall installed on your PC allows any connections from the virtual machines to your host machine.  You just need to open the ports 80,20,21 and the range 40000-50000 on your host machine and you should be fine.</p>"},{"location":"Environment%20setup/Local%20lab%20setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"Environment%20setup/Local%20lab%20setup/#network","title":"Network","text":""},{"location":"Environment%20setup/Local%20lab%20setup/#i-cant-access-any-of-my-services","title":"I can't access any of my services !","text":"<p>Please verify the following points : - Make sure that the service you want to access is running - Make sure that the firewall doesn't block incoming and outgoing connections on the host machine     - Make sure that the firewall configuration is persistent, even after the restart of the host machine</p>"},{"location":"Environment%20setup/Local%20lab%20setup/#ftp-server_1","title":"FTP server","text":""},{"location":"Environment%20setup/Local%20lab%20setup/#i-dont-have-access-to-the-uploaded-files-and-folder-from-my-host-machine-with-my-main-account","title":"I don't have access to the uploaded files and folder from my host machine with my main account !","text":"<p>Run this command to add your main account in the same group as the user used for the ftp server :  Text Only<pre><code>sudo usermod -a -G ftpuser $(whoami)\n</code></pre> From now on, you should have access to all files and folder which will be created in the path /var/ftp/pub/home directory. </p>"},{"location":"Environment%20setup/Toolbag%20setup/","title":"Toolbag setup","text":"<p>This page aims to give tricks regarding the physical equipment you might need to buy if you want to realize forensic investigation. Please note that I'm not affiliated to any trademarks, this reflects only my own choices and opinions.</p>"},{"location":"Environment%20setup/Toolbag%20setup/#choosing-the-right-tools","title":"Choosing the right tools","text":""},{"location":"Environment%20setup/Toolbag%20setup/#miscellaneous-tools","title":"Miscellaneous tools","text":""},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-storage-media","title":"Tools for storage media","text":""},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-flash-memory-media","title":"Tools for flash memory media","text":"<p>Here's the different flash memory media you might encounter during your investigation : </p>"},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-hard-drive-media","title":"Tools for hard drive media","text":""},{"location":"Environment%20setup/Toolbag%20setup/#what-is-the-size-of-your-hard-drive","title":"What is the size of your hard drive ?","text":"<p>Here's the list of possible size you might encounter during your investigation.</p> <ul> <li>3.5 inches (Need additionnal power)</li> <li>2.5 inches (Don't need additionnal power)</li> </ul> <p>Here's an example of two hard drives.</p>"},{"location":"Environment%20setup/Toolbag%20setup/#what-is-the-connection-of-your-hard-drive","title":"What is the connection of your hard drive ?","text":"<p>Here's the list of possible connection you might encounter during your investigation.</p> <ul> <li>SATA connection</li> <li>3.5 IDE connection with molex-DP4 connection for power</li> <li>2.5 IDE connection</li> </ul> <p>Here's an example of the differents connection.</p>"},{"location":"Environment%20setup/Toolbag%20setup/#how-to-read-the-hard-drive","title":"How to read the hard drive","text":""},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-any-electronic-devices","title":"Tools for any electronic devices","text":""},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-any-other-storage-media","title":"Tools for any other storage media","text":""},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-data-acquisition","title":"Tools for data acquisition","text":"<p>My recommendation is that you have an hard drive with a very large capacity to be able to retrieve data properly from hard drive and RAM memory. At least 4TB hard drive are recommended for this purpose.</p>"},{"location":"Environment%20setup/Toolbag%20setup/#memory-acquisition","title":"Memory acquisition","text":""},{"location":"Environment%20setup/Toolbag%20setup/#storage-media-cloning","title":"Storage media cloning","text":""},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-booting-up-on-another-distro","title":"Tools for booting up on another distro","text":""},{"location":"Environment%20setup/Toolbag%20setup/#choosing-the-right-bag","title":"Choosing the right bag","text":""},{"location":"Environment%20setup/Toolbag%20setup/#take-away-list","title":"Take-away list","text":"<p>Personnally, here is the full content of my toolbag : </p>"},{"location":"Environment%20setup/Toolbag%20setup/#miscellaneous","title":"Miscellaneous","text":"<ul> <li>Latex gloves</li> <li>Pen and pencil</li> <li>Notebook</li> <li>Paper tag</li> <li>Multitool</li> <li>Light torch</li> <li>Charger cable with multiple output (USB-C, Lightning, Micro-USB)</li> <li>pliers</li> </ul>"},{"location":"Environment%20setup/Toolbag%20setup/#storage-media","title":"Storage media","text":""},{"location":"Environment%20setup/Toolbag%20setup/#flash-memory","title":"Flash memory","text":"<ul> <li>Adapter 20 in 1 for memory cards</li> <li>SD, Mini SD and micro sd to USB-A adapter</li> </ul>"},{"location":"Environment%20setup/Toolbag%20setup/#hard-drive","title":"Hard drive","text":"<ul> <li>Adapter for hard drive (From 2.5, 3.5 SATA and IDE Hard drive to USB-A male)</li> <li>3.5 inches Hard drive case with a 4TB hard drive</li> </ul>"},{"location":"Environment%20setup/Toolbag%20setup/#any-electronic-devices","title":"Any electronic devices","text":"<ul> <li>USB-C cable</li> <li>Lightning cable</li> <li>Micro-USB cable</li> <li>USB cable extender</li> <li>A set of adapter :<ul> <li>USB-A \u2192 USB-C</li> <li>Lightning \u2192 USB-C</li> <li>USB-C \u2192 Lightning</li> <li>USB-C \u2192 USB-A </li> </ul> </li> </ul>"},{"location":"Environment%20setup/Toolbag%20setup/#any-other-storage-media","title":"Any other storage media","text":"<ul> <li>Blu-ray, DVD, CD-Rom writer and reader to USB-A adapter</li> </ul>"},{"location":"Environment%20setup/Toolbag%20setup/#appendix","title":"Appendix","text":""},{"location":"Environment%20setup/Toolbag%20setup/#flash-memory-format","title":"Flash memory format","text":"<ul> <li>USB-A storage key</li> <li>USB-C storage key</li> <li>Lightning storage key</li> <li>Micro-USB storage key</li> <li>Memory stick card<ul> <li>Memory Stick PRO-HG Duo</li> <li>Memory Stick PRO Duo</li> <li>Memory Stick PRO-HG</li> <li>Memory Stick PRO</li> <li>Memory Stick Duo</li> <li>Memory Stick Micro (M2)</li> <li>Memory Stick Pro</li> </ul> </li> <li>CompactFlash (CF) micro memory card</li> <li>Secure digital (SD) memory card<ul> <li>Secure Digital High Capacity (SDHC) memory card</li> <li>Secure Digital Extended Capacity (SDXC) memory card</li> </ul> </li> <li>Mini-SD memory card<ul> <li>MiniSDHC memory card</li> </ul> </li> <li>Micro-SD memory card<ul> <li>Micro-SD High Capacity (MicroSDHC) memory card</li> <li>Micro-SD Extended Capacity (MicroSDXC) memory card</li> </ul> </li> <li>Extreme Digital (xD) Picture Card memory card</li> <li>Compact Flash<ul> <li>CompactFlash I</li> <li>CompactFlash II</li> </ul> </li> <li>Reduced-Size MultiMediaCard (RS-MMC)</li> <li>Olympus DC card</li> <li>M2 memory card</li> </ul>"},{"location":"Environment%20setup/Volatility%20setup/","title":"Volatility 2 and 3 setup","text":"<p>The aim of this pages is to give tips and tricks regarding the installation and setup of Volatility 2 and 3.</p>"},{"location":"Environment%20setup/Volatility%20setup/#install-volatility","title":"Install Volatility","text":""},{"location":"Environment%20setup/Volatility%20setup/#volatility-2","title":"Volatility 2","text":""},{"location":"Environment%20setup/Volatility%20setup/#volatility-3","title":"Volatility 3","text":""},{"location":"Environment%20setup/Volatility%20setup/#get-custom-existing-volatility-profile-and-symbols","title":"Get custom existing volatility profile and symbols","text":""},{"location":"Environment%20setup/Volatility%20setup/#precompiled-memory-profile-and-symbols","title":"Precompiled memory profile and symbols","text":""},{"location":"Environment%20setup/Volatility%20setup/#volatility-2_1","title":"Volatility 2","text":"<p>Here's a list of repo on which you can find precompiled memory profile for volatility2</p> Description Link Volatility2 symbols from Podalirius Link Volatlity2 Compilation of volatility2 profiles by volatility foundation Link #### Volatility 3 Here's a list of repo on which you can find precompiled symbols for volatility3 Description Link Volatility3 symbols from Podalirius Link Isf server from techanarchy Link Volatility 3 symboles tables Link ### Creating you own memory profile and symbols #### Windows Volatility2 and 3 comes with a lot of prebuilts profiles and symbols for Windows"},{"location":"Environment%20setup/Volatility%20setup/#mac-os-x","title":"Mac OS X","text":""},{"location":"Environment%20setup/Volatility%20setup/#volatility2","title":"Volatility2","text":"<p>You can find pre-builts volatility profile on this link : https://github.com/volatilityfoundation/profiles</p>"},{"location":"Environment%20setup/Volatility%20setup/#volatility3","title":"Volatility3","text":""},{"location":"Environment%20setup/Volatility%20setup/#linux","title":"Linux","text":""},{"location":"Environment%20setup/Volatility%20setup/#volatility2_1","title":"Volatility2","text":""},{"location":"Environment%20setup/Volatility%20setup/#create-a-virtual-machine-to-build-symbols-or-a-memory-profile","title":"Create a virtual machine to build symbols or a memory profile","text":"Text Only<pre><code>gunzip QEMU_EFI.img.gz\nqemu-img create -f qcow2 debian.img 128G\nqemu-img create -f qcow2 varstore.img 64M\n\nqemu-system-aarch64 \\\n    -cpu cortex-a53 -M virt -m 4096 \\\n    -drive if=pflash,format=raw,file=QEMU_EFI.img \\\n    -drive if=pflash,file=varstore.img \\\n    -drive if=virtio,file=debian.img \\\n    -drive if=virtio,format=raw,file=ubuntu-18.04.6-server-arm64.iso\n\nqemu-system-aarch64 \\\n    -cpu host -M virt,accel=kvm -m 4096 -nographic \\\n    -kernel arch/arm64/boot/Image -append root=/dev/vda2 \\\n    -drive if=virtio,file=debian.img\n</code></pre>"},{"location":"Environment%20setup/Volatility%20setup/#android","title":"Android","text":"<p>https://github.com/SorCelien/CTF-WRITEUPS/blob/main/FCSC-2021/forensics/ordiphone-1.md</p> Bash<pre><code>mkdir ~/android-kernel &amp;&amp; cd ~/android-kernel\nrepo init -u https://android.googlesource.com/kernel/manifest - kernel_version\nrepo sync -c -j8\nBUILD_CONFIG=common/build.config.gki.x86_64 build/build.sh\n</code></pre>"},{"location":"Environment%20setup/Volatility%20setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"Environment%20setup/Volatility%20setup/#stuck-on-lto-vmlinuxo-during-kernel-compile","title":"Stuck on \"LTO vmlinux.o\" during kernel compile","text":"<p>There is not enough memory allocated to the compiler during link of vmlinux.o file. Create a swapfile to allocate more memory by using these commands Text Only<pre><code>sudo -i #Become root\ndd if=/dev/zero of=/path/swapfile bs=1G count=size_of_swapfile status=progress #Create swap file\nchmod 600 /path/swapfile #Modify permissions so only root can use it\nmkswap /path/swapfile #Make the file a swap file\nswapon /path/swapfile #Enable the swap file\ncat /proc/swaps # Check that the swapfile is indeed used by system\necho \"/path/swapfile        none        swap        sw        0        0\" &gt;&gt; /etc/fstab\n</code></pre></p>"},{"location":"Environment%20setup/Volatility%20setup/#configure-volatility-2-and-3-to-use-them","title":"Configure volatility 2 and 3 to use them","text":""},{"location":"Environment%20setup/Volatility%20setup/#adding-a-custom-memory-profile-or-symbols","title":"Adding a custom memory profile or symbols","text":""},{"location":"Environment%20setup/Volatility%20setup/#volatility-2_2","title":"Volatility 2","text":"<p>Once you found the appropriate memory profile for your investigation, you need to setup Volatility2 in order to use it. Here's the following steps to do this.</p>"},{"location":"Environment%20setup/Volatility%20setup/#volatility-3_1","title":"Volatility 3","text":"<p>Once you found the appropriate symbols for your memory dump, you need to setup Volatility3 in order to use it. Here's the following steps to do this.</p>"},{"location":"Environment%20setup/Volatility%20setup/#resources","title":"Resources","text":"<p>https://source.android.com/docs/setup/build/building-kernels</p> <p>https://github.com/volatilityfoundation/volatility/wiki/Androiddir</p> <p>https://unix.stackexchange.com/questions/238783/how-can-i-create-a-swap-file</p>"},{"location":"Environment%20setup/Workstation%20setup/","title":"Workstation setup","text":"<p>This page aims to give instructions to help you setup a forensic workstation. Regarding the configuration of your forensic workstation, you have two choices. The first one is using an existant distro tuned from Vanilla Debian, Ubuntu OS or create your own distro from scratch. Please consult the right section based on your needs. </p>"},{"location":"Environment%20setup/Workstation%20setup/#using-an-existant-distro","title":"Using an existant distro","text":"<p>Using an existant distro can be very useful if you want to setup a forensic workstation as a VM. You can find on the following table, the existing distro for the forensic world.</p>"},{"location":"Environment%20setup/Workstation%20setup/#linux","title":"Linux","text":"<p>Here is a list of distros based on Linux to meet forensic needs.</p> Linux OS for forensic and reverse engineering purposes Name Description OS Link Tsuguri Forensic distro which includes popular forensic and OSINT tools. Best run as an installed OS Based on Ubuntu Tsuguri-linux PALADIN Forensic distro which aims to provide tools for disk imaging and data viewer. Best run as a live session. Based on Ubuntu Sumuri CAINE Forensic distro which aims to provide basic forensic tools like Autopsy, testdisk, phororec... Both ways are fine with this OS. Based on Ubuntu CAINE GRML Forensic distro which aims to provide basic forensic tools for disk imaging. Best run as a live session Based on Grml Linux live which is itself based on Debian GRML Forensic Renmux Linux distro dedicated to reverse-engineering. Best run as an installed OS. Base on Ubuntu Renmux Challenger OS Data recovery distro which aims to provide rescue tools to save data from disk. Best run as an installed OS. Based on slackware ChallengerOS DEFT Zero Forensic distro which aims to provide basic forensic tools like Autopsy, testdisk, photorec... Both ways are fine with this OS REDACTED Discontinued Trace Labs VM Kali Linux OS tuned to suit OSINT purposes Based on Kali Linux TRACE Labs VM <p>Paladin, GRML are distro which are best run as a live session whereas Renmux, Tsuguri is best run as an installed OS. CAINE and DEFT Zero are fine in either way. Please note that all of these OS have built-in write blocking protection for any storage media plugged on the computer. </p>"},{"location":"Environment%20setup/Workstation%20setup/#windows","title":"Windows","text":"<p>Here is a list of distros based on Windows to meet forensic needs.</p> Windows OS for forensic and reverse engineering purposes Name Description OS Link FLARE VM Reverse engineering distributions for windows malware analysis Based on Microsoft Windows FLARE VM <p>Personally, I have this setup : </p> My setup <ul> <li>A raspberry PI 3 with a modified kernel to clone hard drive for forensic purposes</li> <li>A laptop with the following virtual machines <ul> <li>a VM with Parrot OS (Linux) installed for pentest and forensic purposes</li> <li>a VM with Flare VM (Windows) for the reverse engineering of windows malwares</li> <li>a VM with Flare VM (Windows) for forensic purposes</li> <li>a VM with Remnux install for the reverse engineering of linux malwares</li> <li>a VM with a distro from Trace Labs VM for OSINT purposes. </li> </ul> </li> </ul> <p>Please keep in mind that the best setup you can have is the one which suit you the best. Don't hesitate to experiment several distros to see the ones you like the most.</p>"},{"location":"Environment%20setup/Workstation%20setup/#setting-your-workstation-from-scratch","title":"Setting your workstation from scratch","text":""},{"location":"Environment%20setup/Workstation%20setup/#step-n-1-choose-the-right-distro","title":"Step N\u00b0 1 : Choose the right distro","text":"<p>The first step is to choose the right linux distro. The key here is to choose a Linux OS you're comfortable with. If you have no idea of which one to use, you can try Debian, Ubuntu or Slackware</p>"},{"location":"Environment%20setup/Workstation%20setup/#step-n-2-install-the-distro","title":"Step N\u00b0 2 : Install the distro","text":""},{"location":"Environment%20setup/Workstation%20setup/#step-n-3-configuring-your-workstation","title":"Step N\u00b0 3 : Configuring your workstation","text":"<p>To avoid unwanted actions on digital evidence such as storage media, we want to make sure that any storage media plugged to our workstation will be marked as \"Read-only\". Even though a storage media can have the flag \"Read-only\", it will be still possible for the linux kernel to do write I/O on the storage media. To avoid this issue, you have two ways : </p>"},{"location":"Environment%20setup/Workstation%20setup/#buyinstall-a-hardware-write-blocker","title":"Buy/Install a hardware write blocker","text":"<p>These device are placed between the workstation and the evidence you want to analyze. Their primary goal is to block any attempt from the workstation to realize write operation on the evidence. The massive cons of this technology is that it can be very expensive to buy one of this devices for the benefits.</p>"},{"location":"Environment%20setup/Workstation%20setup/#buyinstall-a-software-write-blocker","title":"Buy/Install a software write blocker","text":"<p>A software write blocker works in the same fashion as a hardware write blocker except that it is a software which is running on your workstation. It can be a third parties software or a even a patch on the Linux kernel. As long as the software configuration is correctly done, its reliability will be the same as an hardware write blocker.</p>"},{"location":"Environment%20setup/Workstation%20setup/#how-to-patch-and-recompile-our-own-linux-kernel","title":"How to patch and recompile our own linux kernel","text":"<p>In this section, I'm going to explain how to patch your own kernel to \"truly\" mark a storage-media as \"Read-only\" and avoid unwanted write I/O on digital evidences. The first step you need to do is to open a terminal and type this command :</p> Text Only<pre><code>uname -r\n</code></pre> <p>Based on the output, please refer to the tailored section to your needs to configure your kernel.</p>"},{"location":"Environment%20setup/Workstation%20setup/#version-superior-to-3151-414-54","title":"Version superior to 3.15.1, 4.14, 5.4","text":"<p>First, you need to install the following packages : </p>"},{"location":"Environment%20setup/Workstation%20setup/#debian-ubuntu","title":"Debian, Ubuntu","text":"<p>Text Only<pre><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade &amp;&amp; sudo apt-get install \n</code></pre> Once it's done, go to /usr/src to find the kernel source. You will need to find the kernel version you want to install. Consult this link to download the right kernel https://kernel.org/pub/linux/kernel/ Then, download the kernel file on your PC :  Text Only<pre><code>wget https://link/to/kernel/file.com #Download the kernel\nwget https://link/to/kernel/signature.com #Download the kernel signature\n</code></pre> Uncompress the archive and check the signature  Text Only<pre><code>tar -xvzf archive.tar.gz | gpg --verify linux-5.10.62.tar.sign - #If archive is a tar.gz file\nunxz -c linux-5.10.62.tar.xz | gpg --verify linux-5.10.62.tar.sign - #If archive is a tar.xz file\n</code></pre> Once you have the archive, launch the following command Text Only<pre><code>cp /boot/config-5.10.0-8-amd64 ~/kernel/linux-source-5.10/.config #Keep the new configuration as close as possible to the previous kernel version\n</code></pre> Before we go compile the kernel, we need to several files to activate the write blocking ability of the kernel. Text Only<pre><code>any_text_editor_software ~/kernel/config-version/block/blk-core.c\n</code></pre> Go to the line N\u00b0 708 or to the function bio_check_ro(struct bio *bio, struct hd_struct *part) and change this line :  Text Only<pre><code>return false\n</code></pre> to Text Only<pre><code>return true\n</code></pre> Once it's done, you can save and close the file. Now that we have patched the source code of the downloaded kernel, we can begin to compile the kernel. </p> <p>Please consult the \"Credits\" section if you want to have additionnal informations regarding this patch from Maxim Suhanov.</p>"},{"location":"Environment%20setup/Workstation%20setup/#step-n-4-install-the-needed-packages","title":"Step N\u00b0 4 : Install the needed packages","text":"<p>Now that we have the right foundation to create our forensic workstation, we need to downloads the software which will be needed for forensic purposes.</p>"},{"location":"Environment%20setup/Workstation%20setup/#step-n-5-post-installation","title":"Step N\u00b0 5 : Post-installation","text":"<p>If you have successfully accomplished all the previous steps, then congralutations ! Enjoy your tuned workstation and don't forget to create a snapshot if it is a virtual machine. This will allow you to go back to a functionnal version of your VM in case you have broken it. </p>"},{"location":"Environment%20setup/Workstation%20setup/#credits","title":"Credits","text":"<p>Original linux kernel patch for software write blocker : Link N\u00b0 1 Forked linux kernel patch for software write blocker : Link N\u00b0 2</p>"}]}